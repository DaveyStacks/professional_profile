if (self.CavalryLogger) { CavalryLogger.start_js(["Wcilx"]); }

__d("GLTFSceneLogEvents",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({GLTF_SCENE_NETWORK_LOAD_START:"gltf_scene_network_load_start",GLTF_SCENE_NETWORK_LOAD_END:"gltf_scene_network_load_end",GLTF_SCENE_GLB_PARSING_START:"gltf_scene_glb_parsing_start",GLTF_SCENE_GLB_PARSING_END:"gltf_scene_glb_parsing_end",GLTF_SCENE_GPU_UPLOAD_START:"gltf_scene_gpu_upload_start",GLTF_SCENE_GPU_UPLOAD_END:"gltf_scene_gpu_upload_end",GLTF_SCENE_AVG_RENDER_FRAME_RATE:"gltf_scene_avg_render_frame_rate",GLTF_SCENE_ON_TOUCH_PAN_END:"gltf_scene_on_touch_pan_end",GLTF_SCENE_ON_TOUCH_PINCH_END:"gltf_scene_on_touch_pinch_end",GLTF_SCENE_WRITE_TIME:"gltf_scene_write_time",GLTF_SCENE_ON_FAKE_GYRO_END_WWW:"gltf_scene_on_fake_gyro_end_www",GLTF_SCENE_VIEWPORT_SIZE_ERROR:"gltf_scene_viewport_size_error"})}),null);
__d("GltfScenePerformanceTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:GltfScenePerformanceLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:GltfScenePerformanceLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:GltfScenePerformanceLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setActiveDurationMs=function(a){this.$1.active_duration_ms=a;return this};a.prototype.setAsset3dID=function(a){this.$1.asset3d_id=a;return this};a.prototype.setCompressionLevel=function(a){this.$1.compression_level=a;return this};a.prototype.setCompressionType=function(a){this.$1.compression_type=a;return this};a.prototype.setEvent=function(a){this.$1.event=a;return this};a.prototype.setGltfSceneAvgRenderFrameRate=function(a){this.$1.gltf_scene_avg_render_frame_rate=a;return this};a.prototype.setSceneURL=function(a){this.$1.scene_url=a;return this};a.prototype.setStartTimeMs=function(a){this.$1.start_time_ms=a;return this};a.prototype.setStoryID=function(a){this.$1.story_id=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={active_duration_ms:!0,asset3d_id:!0,compression_level:!0,compression_type:!0,event:!0,gltf_scene_avg_render_frame_rate:!0,scene_url:!0,start_time_ms:!0,story_id:!0,vc:!0};e.exports=a}),null);
__d("GLTFSceneLoggerUtils",["GltfScenePerformanceTypedLogger","GLTFSceneLogEvents"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b,c){this.data={frameCount:0,timeSinceLastFPSLogMs:0,touchPanStartMs:0,fakeGyroStartMs:0},this.$1={asset3dID:a,sceneURL:b,storyID:c}}a.prototype.logNetworkLoadEvents=function(a,c,d){this.$2(b("GLTFSceneLogEvents").GLTF_SCENE_NETWORK_LOAD_START,{startTimeMs:a.networkLoad.startTimeMs}),this.$2(b("GLTFSceneLogEvents").GLTF_SCENE_NETWORK_LOAD_END,{activeDurationMs:a.networkLoad.durationMs,compressor:c,compressionLevel:d})};a.prototype.logGpuUploadStart=function(){this.$2(b("GLTFSceneLogEvents").GLTF_SCENE_GPU_UPLOAD_START)};a.prototype.logGpuUploadEnd=function(a){this.$2(b("GLTFSceneLogEvents").GLTF_SCENE_GPU_UPLOAD_END,{activeDurationMs:a})};a.prototype.logAverageFrameRate=function(a){this.$2(b("GLTFSceneLogEvents").GLTF_SCENE_AVG_RENDER_FRAME_RATE,{averageFrameRate:a})};a.prototype.logGlbParsingEvents=function(a){this.$2(b("GLTFSceneLogEvents").GLTF_SCENE_GLB_PARSING_START,{startTimeMs:a.glbParsing.startTimeMs}),this.$2(b("GLTFSceneLogEvents").GLTF_SCENE_GLB_PARSING_END,{activeDurationMs:a.glbParsing.durationMs})};a.prototype.logOnTouchPanEnd=function(a){this.$2(b("GLTFSceneLogEvents").GLTF_SCENE_ON_TOUCH_PAN_END,{activeDurationMs:a})};a.prototype.logOnFakeGyroEnd=function(a){if(a<1e3)return;this.$2(b("GLTFSceneLogEvents").GLTF_SCENE_ON_FAKE_GYRO_END_WWW,{activeDurationMs:a})};a.prototype.logViewportSizeError=function(){this.$2(b("GLTFSceneLogEvents").GLTF_SCENE_VIEWPORT_SIZE_ERROR)};a.prototype.$2=function(a){var c=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],d=new(b("GltfScenePerformanceTypedLogger"))().setEvent(a).setAsset3dID(this.$1.asset3dID).setSceneURL(this.$1.sceneURL).setActiveDurationMs(c.activeDurationMs).setStartTimeMs(c.startTimeMs).setGltfSceneAvgRenderFrameRate(c.averageFrameRate);this.$1.storyID&&d.setStoryID(this.$1.storyID);d.log()};e.exports=a}),null);
__d("Asset3dCameraControl",["ThreeJS.r88","degToRad","SphericalViewportControl","GLTFSceneLoggerUtils"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("SphericalViewportControl").SphericalViewportControl;b("SphericalViewportControl").Vector;var g=.01,h=2e3,i=b("degToRad")(270),j=b("degToRad")(0),k=50;function a(a,c,d,e,f){this.__cameraTarget=new(b("ThreeJS.r88").Vector3)(),this.__cameraAnchor=new(b("ThreeJS.r88").Object3D)(),this.__width=0,this.__height=0,this.__yaw=i,this.__pitch=j,this.__dirty=!0,this.__initialOrientation=null,this.__cameraInitialPosition=null,this.__cameraInitialTarget=null,this.__width=c,this.__height=d,this.__camera=new(b("ThreeJS.r88").PerspectiveCamera)(k,this.__width/this.__height,g,h),this.__cameraAnchor.add(this.__camera),f.add(this.__cameraAnchor),this.__sphericalViewportControl=a,this.__loggerUtils=e,this.setupViewportListeners(),this.__dirty=!0}a.prototype.modelLoad=function(a){};a.prototype.setupViewportListeners=function(){};a.prototype.update=function(a){};a.prototype.camera=function(){return this.__camera};a.prototype.destroy=function(){};a.prototype.isDirty=function(){return this.__dirty};a.prototype.setDirty=function(a){this.__dirty=a};a.prototype.resetCamera=function(){};a.prototype.__updateResetCamera=function(){};a.prototype.shouldSuppressNux=function(){return!0};a.prototype.__updateCameraAnchor=function(a,b){var c=-.001*Math.cos(a)*Math.cos(b),d=.001*Math.sin(a);a=-.001*Math.cos(a)*Math.sin(b);this.__cameraAnchor.position.set(c+this.__cameraTarget.x,d+this.__cameraTarget.y,a+this.__cameraTarget.z);this.__cameraAnchor.lookAt(this.__cameraTarget)};e.exports=a}),null);
__d("Asset3dContextMenu",["EventListener","UserAgent","CurrentUser","React","ReactXUIMenu","MountedContextMenu.react","ReactDOM","Event"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("ReactXUIMenu").Item;function a(a,c,d){this.$5=function(a){var c=/^a$/i.test(a.target.nodeName||""),d=b("UserAgent").isPlatform("Mac OS X")?a.getModifiers().meta:a.getModifiers().ctrl;c=!c&&b("CurrentUser").isEmployee()&&d;c?(a.preventDefault(),this.$6()):(b("ReactDOM").unmountComponentAtNode(this.$1),delete this.$3)}.bind(this),this.$1=a,this.$2=c,this.$4=d,b("EventListener").listen(c,"contextmenu",this.$5)}a.prototype.$6=function(){if(this.$2){var a=void 0;this.$4&&(a=b("React").createElement(g,{href:this.$4,target:"_blank"},"Download 3D File"));a=b("React").createElement(b("ReactXUIMenu"),null,a);a=b("React").createElement(b("MountedContextMenu.react"),{mountedTriggerElem:this.$2,menu:a});this.$3=b("ReactDOM").render(a,this.$1)}};e.exports=a}),null);
__d("Asset3dComponentContextMenu.react",["React","Asset3dContextMenu"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.componentDidMount=function(){this.props.target&&(this.$1=new(b("Asset3dContextMenu"))(this.refs.container,this.props.target,this.props.fileURL))};a.prototype.render=function(){return b("React").createElement("div",{ref:"container"})};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("Asset3DCategory",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({UNSPECIFIED:"unspecified",MEDIUM:"medium",SPACES_MARKER_DRAWING:"spaces_marker_drawing",METAVERSITY:"metaversity",PHOTOS_3D:"photos_3d",THIRD_PARTY:"third_party",LINK_SCRAPE:"link_scrape",COMPOSER:"composer",QUILLUSTRATION:"quillustration"})}),null);
__d("Asset3DStatus",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({UPLOADING:"uploading",SUCCESS:"success",FAIL:"fail"})}),null);
__d("Asset3dEnterVrButton.react",["ix","FDSButton.react","React","asset","Image"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={inVr:!1},b}a.prototype.setInVr=function(a){this.setState({inVr:a})};a.prototype.render=function(){var a={position:"absolute",bottom:"22px",right:"22px"},c=this.state.inVr?b("React").createElement(b("Image"),{source:g("528152")}):b("React").createElement(b("Image"),{source:g("556058")});return b("React").createElement(b("FDSButton.react"),{label:"VR Button",labelIsHidden:!0,use:"flatWhite",icon:c,onClick:function(){!this.state.inVr?this.props.enterVrCallback():this.props.exitVrCallback()}.bind(this),style:a})};a.defaultProps={};e.exports=a}),null);
__d("Asset3dTurntableCameraControl",["Asset3dCameraControl","Ease","ThreeJS.r88","Tween","degToRad","radToDeg","requestAnimationFrame"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("degToRad")(-70),i=b("degToRad")(100),j=1.2,k=.01,l=30,m=.95,n=.1,o=10,p=.05,q=.001,r=6.5,s=1.2,t=Object.freeze({FAKE_GYRO_INITIAL:"fake_gyro_initial",FOCUS_STATE:"focus_state",FAKE_GYRO_AFTER_FOCUS:"fake_gyro_after_focus"});c=babelHelpers.inherits(a,b("Asset3dCameraControl"));g=c&&c.prototype;function a(a,c,d,e,f){__p&&__p();g.constructor.call(this,a,c,d,e,f),this.$Asset3dTurntableCameraControl1=new(b("ThreeJS.r88").Object3D)(),this.$Asset3dTurntableCameraControl2=new(b("ThreeJS.r88").Object3D)(),this.$Asset3dTurntableCameraControl3=new(b("ThreeJS.r88").Vector3)(),this.$Asset3dTurntableCameraControl4=new(b("ThreeJS.r88").Vector3)(),this.$Asset3dTurntableCameraControl8=0,this.$Asset3dTurntableCameraControl9=!1,this.$Asset3dTurntableCameraControl11=t.FAKE_GYRO_INITIAL,this.$Asset3dTurntableCameraControl14=null,this.__updateResetCamera=function(){__p&&__p();var a=this.__sphericalViewportControl.getOrientation();Math.abs(a.x-this.__initialOrientation.x)>180&&(a.x>this.__initialOrientation.x?a.x-=360:a.x+=360);this.__sphericalViewportControl.setSphericalOrientation(a.x+p*(this.__initialOrientation.x-a.x),a.y+p*(this.__initialOrientation.y-a.y));var c=this.__camera.position;c.set(c.x+p*(this.__cameraInitialPosition.x-c.x),c.y+p*(this.__cameraInitialPosition.y-c.y),c.z+p*(this.__cameraInitialPosition.z-c.z));var d=this.__cameraTarget;d.set(d.x+p*(this.__cameraInitialTarget.x-d.x),d.y+p*(this.__cameraInitialTarget.y-d.y),d.z+p*(this.__cameraInitialTarget.z-d.z));this.$Asset3dTurntableCameraControl1.position.x+=p*(this.$Asset3dTurntableCameraControl12-this.$Asset3dTurntableCameraControl1.position.x);this.$Asset3dTurntableCameraControl2.position.y+=p*(this.$Asset3dTurntableCameraControl13-this.$Asset3dTurntableCameraControl2.position.y);var e=Math.abs(a.x);a=Math.abs(a.y);var f=Math.abs(c.x-this.__cameraInitialPosition.x),g=Math.abs(c.y-this.__cameraInitialPosition.y);c=Math.abs(c.z-this.__cameraInitialPosition.z);var h=Math.abs(d.x-this.__cameraInitialTarget.x),i=Math.abs(d.y-this.__cameraInitialTarget.y);d=Math.abs(d.z-this.__cameraInitialTarget.z);(e>q||a>q||f>q||g>q||c>q||h>q||i>q||d>q)&&this.$Asset3dTurntableCameraControl14?this.$Asset3dTurntableCameraControl14=b("requestAnimationFrame")(this.__updateResetCamera):this.$Asset3dTurntableCameraControl14=null}.bind(this),this.__camera.name="Turntable Camera",this.$Asset3dTurntableCameraControl10=new(b("Tween"))()}a.prototype.setupViewportListeners=function(){__p&&__p();this.__sphericalViewportControl.addListener("viewportChange",function(a,c,d){this.__yaw=b("degToRad")(a),this.__pitch=b("degToRad")(-c),this.$Asset3dTurntableCameraControl11===t.FOCUS_STATE&&(this.__pitch=Math.min(b("degToRad")(45),Math.max(this.__pitch,b("degToRad")(-45)))),this.setDirty(!0)}.bind(this)),this.__sphericalViewportControl.addListener("mouseMove",function(a){this.$Asset3dTurntableCameraControl9&&(this.__sphericalViewportControl.setMovementPosition(a),this.$Asset3dTurntableCameraControl9=!1),this.setDirty(!0)}.bind(this)),this.__sphericalViewportControl.addListener("wheelScrollWithShiftKey",function(a,b){this.setDirty(!0);this.$Asset3dTurntableCameraControl14=null;var c=this.__camera.position.length();a>0?c<this.$Asset3dTurntableCameraControl6&&(this.$Asset3dTurntableCameraControl15((1-1/m)*b.x,(1/m-1)*b.y),this.__camera.position.divideScalar(m),this.$Asset3dTurntableCameraControl1.position.divideScalar(m),this.$Asset3dTurntableCameraControl2.position.divideScalar(m)):a<0&&(c>this.$Asset3dTurntableCameraControl5&&(this.$Asset3dTurntableCameraControl15((1-m)*b.x,(m-1)*b.y),this.__camera.position.multiplyScalar(m),this.$Asset3dTurntableCameraControl1.position.multiplyScalar(m),this.$Asset3dTurntableCameraControl2.position.multiplyScalar(m)))}.bind(this)),this.__sphericalViewportControl.addListener("panningWithRightMouse",function(a){this.$Asset3dTurntableCameraControl15(-a.x,a.y),this.setDirty(!0),this.$Asset3dTurntableCameraControl14=null}.bind(this)),this.__sphericalViewportControl.addListener("updateViewportMoveStart",function(a){this.$Asset3dTurntableCameraControl14=null,this.__loggerUtils.data.fakeGyroStartMs=Date.now()}.bind(this)),this.__sphericalViewportControl.addListener("updateViewportMove",function(a){this.$Asset3dTurntableCameraControl10.stop(),this.setDirty(!0)}.bind(this)),this.__sphericalViewportControl.addListener("updateViewportEnd",function(a,c){this.$Asset3dTurntableCameraControl7=c,this.$Asset3dTurntableCameraControl8=a,this.$Asset3dTurntableCameraControl11===t.FOCUS_STATE?(this.$Asset3dTurntableCameraControl11=t.FAKE_GYRO_AFTER_FOCUS,this.__sphericalViewportControl.setSphericalOrientation(b("radToDeg")(this.__yaw),b("radToDeg")(-this.__pitch)),this.__sphericalViewportControl.setAngularVelocityScaleFactor({x:1,y:1}),this.__sphericalViewportControl.reEnableGyro(),this.$Asset3dTurntableCameraControl9=!0,this.__loggerUtils.logOnTouchPanEnd(Date.now()-this.__loggerUtils.data.touchPanStartMs),this.__loggerUtils.data.fakeGyroStartMs=Date.now()):this.__loggerUtils.logOnFakeGyroEnd(Date.now()-this.__loggerUtils.data.fakeGyroStartMs),this.$Asset3dTurntableCameraControl16()}.bind(this)),this.__sphericalViewportControl.addListener("onMovementStart",function(a){this.$Asset3dTurntableCameraControl14=null,this.$Asset3dTurntableCameraControl10.stop(),this.setDirty(!0),this.$Asset3dTurntableCameraControl11!==t.FOCUS_STATE&&(this.$Asset3dTurntableCameraControl11=t.FOCUS_STATE,this.__sphericalViewportControl.setAngularVelocityScaleFactor({x:r,y:s}),this.__loggerUtils.data.touchPanStartMs=Date.now(),this.__loggerUtils.logOnFakeGyroEnd(Date.now()-this.__loggerUtils.data.fakeGyroStartMs))}.bind(this))};a.prototype.modelLoad=function(a){__p&&__p();this.setDirty(!0);var c=null,d=null;a.traverse(function(a){a.name==="FB_Post_Camera"?c=a:a.name==="FB_Post_Target"&&(d=a)});var e=void 0;if(c&&d){c.updateMatrixWorld();d.updateMatrixWorld();var f=new(b("ThreeJS.r88").Vector3)().setFromMatrixPosition(c.matrixWorld),g=new(b("ThreeJS.r88").Vector3)().setFromMatrixPosition(d.matrixWorld);this.__cameraTarget.copy(g);this.__camera.near=c.near;this.__camera.far=c.far;this.__camera.fov=c.fov;f.sub(g);e=f.length();f.normalize();g=Math.asin(f.y);f=Math.atan2(f.x,f.z);this.__sphericalViewportControl.setRelativeSphericalOrientation(b("radToDeg")(f),b("radToDeg")(g))}else{f=new(b("ThreeJS.r88").Box3)().setFromObject(a);g=f.getSize();a=g.length();this.__cameraTarget=f.getCenter();this.__camera.near=a*k;this.__camera.far=a*l;e=a*j}this.$Asset3dTurntableCameraControl5=n*e;this.$Asset3dTurntableCameraControl6=o*e;this.__cameraAnchor.position.copy(this.__cameraTarget);this.__camera.position.set(0,0,e);this.$Asset3dTurntableCameraControl2.position.y=2*e*Math.tan(b("degToRad")(this.__camera.fov*.5));this.$Asset3dTurntableCameraControl1.position.x=this.$Asset3dTurntableCameraControl2.position.y*this.__camera.aspect;this.__cameraAnchor.add(this.$Asset3dTurntableCameraControl1);this.__cameraAnchor.add(this.$Asset3dTurntableCameraControl2);this.__camera.updateProjectionMatrix();this.__initialOrientation=this.__sphericalViewportControl.getOrientation();this.__cameraInitialTarget=this.__cameraTarget.clone();this.__cameraInitialPosition=this.__camera.position.clone();this.$Asset3dTurntableCameraControl13=this.$Asset3dTurntableCameraControl2.position.y;this.$Asset3dTurntableCameraControl12=this.$Asset3dTurntableCameraControl1.position.x};a.prototype.update=function(a){if(!this.isDirty())return;a=h+i*(1-a);this.__updateCameraAnchor(this.__pitch+a,-this.__yaw)};a.prototype.$Asset3dTurntableCameraControl15=function(a,b){__p&&__p();var c=this.$Asset3dTurntableCameraControl3,d=this.$Asset3dTurntableCameraControl4;c.set(0,0,0);this.__cameraAnchor.updateMatrixWorld();d.setFromMatrixPosition(this.$Asset3dTurntableCameraControl1.matrixWorld);d.sub(this.__cameraTarget);c.addScaledVector(d,a);d.setFromMatrixPosition(this.$Asset3dTurntableCameraControl2.matrixWorld);d.sub(this.__cameraTarget);c.addScaledVector(d,b);this.__cameraTarget.add(c);this.__cameraAnchor.position.add(c)};a.prototype.$Asset3dTurntableCameraControl16=function(){this.$Asset3dTurntableCameraControl11===t.FAKE_GYRO_INITIAL&&this.$Asset3dTurntableCameraControl10.start(function(a,c){this.setDirty(!0);c=b("Tween").scale(this.$Asset3dTurntableCameraControl8,this.__initialOrientation.x,a);a=b("Tween").scale(this.$Asset3dTurntableCameraControl7,this.__initialOrientation.y,a);this.__sphericalViewportControl.setSphericalOrientation(c,a)}.bind(this),2e3,b("Ease").makePowerIn(3))};a.prototype.resetCamera=function(){this.$Asset3dTurntableCameraControl14||(this.$Asset3dTurntableCameraControl14=b("requestAnimationFrame")(this.__updateResetCamera))};a.prototype.shouldSuppressNux=function(){return this.$Asset3dTurntableCameraControl11===t.FOCUS_STATE};e.exports=a}),null);
__d("Asset3dVrController",["ThreeJS.r88"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=.005,h=[.2,-.5,-.4],i=[-.2,-.5,-.4];function a(a,b,c,d,e){this.$1=a,this.$4=b,this.$5=c,this.$6=d,this.$7=e,this.$9(),window.addEventListener("gamepadconnected",this.$9.bind(this)),window.addEventListener("gamepaddisconnected",this.$9.bind(this)),this.$3=this.$10(b)}a.prototype.$10=function(a){var c=new(b("ThreeJS.r88").Object3D)(),d=new(b("ThreeJS.r88").BoxGeometry)(.05,.05,.05);a=new(b("ThreeJS.r88").MeshBasicMaterial)({color:a});d=new(b("ThreeJS.r88").Mesh)(d,a);c.add(d);return c};a.prototype.$9=function(){__p&&__p();var a=this.isValid();this.$2=-1;if(navigator.getGamepads){var b=navigator.getGamepads();for(var c=0;c<b.length;c++){var d=b[c];if(d&&d.pose&&d.hand===this.$1){this.$2=c;break}}}a!==this.isValid()&&this.$6(this)};a.prototype.render=function(a){__p&&__p();if(navigator.getGamepads&&this.isValid()){var c=navigator.getGamepads();c=c[this.$2];var d=c.pose.orientation,e=c.pose.position;if(!e&&d){var f=new(b("ThreeJS.r88").Vector3)();this.$1=="right"?f.fromArray(h):f.fromArray(i);var j=new(b("ThreeJS.r88").Quaternion)(d[0],d[1],d[2],d[3]);f.applyQuaternion(j);e=[f.x,f.y,f.z]}if(!e){this.$3.visible=!1;return}this.$3.visible=!0;d&&this.$3.quaternion.set(d[0],d[1],d[2],d[3]);this.$3.position.set(e[0]+a.position.x,e[1]+a.position.y,e[2]+a.position.z);if(this.$11(c)){this.$3.children[0].material.setValues({color:this.$5});j=this.$8;if(d&&j){f=d[0]-j[0];Math.abs(f)>=g&&(f>0?this.$7(this,"down"):this.$7(this,"up"));e=d[1]-j[1];Math.abs(e)>=g&&(e>0?this.$7(this,"right"):this.$7(this,"left"))}this.$8=c.pose.orientation}else this.$3.children[0].material.setValues({color:this.$4}),this.$8=null}};a.prototype.model=function(){return this.$3};a.prototype.isValid=function(){return this.$2!==-1};a.prototype.$11=function(a){a=a.buttons;for(var b=0;b<a.length;b++)if(a[b].pressed)return!0;return!1};e.exports=a}),null);
__d("Asset3dVrViewer",["ThreeJS.r88"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.__2dScale=new(b("ThreeJS.r88").Vector3)(),this.__2dPosition=new(b("ThreeJS.r88").Vector3)(),this.__2dRotation=new(b("ThreeJS.r88").Euler)(),this.__frameData=new window.VRFrameData()}a.prototype.setup=function(a,b,c){this.__model=b,this.__2dCamera=a,this.__storyProps=c};a.prototype.onEnterVr=function(a,b){this.__onEnterVr(a)};a.prototype.__onEnterVr=function(a){__p&&__p();this.__scene=new(b("ThreeJS.r88").Scene)();a=new(b("ThreeJS.r88").AmbientLight)(13421772,.5);this.__scene.add(a);this.__scene.add(this.__model);this.__vrCamera=new(b("ThreeJS.r88").PerspectiveCamera)(75,1,.1,2e3);this.__vrCameraAnchor=new(b("ThreeJS.r88").Object3D)();this.__vrCameraAnchor.add(this.__vrCamera);this.__scene.add(this.__vrCameraAnchor);this.__2dScale.copy(this.__model.scale);this.__2dPosition.copy(this.__model.position);this.__2dRotation.copy(this.__model.rotation);this.__applyFrameOrientation=!0};a.prototype.onExitVr=function(){this.__onExitVr()};a.prototype.__onExitVr=function(){this.__model.scale.copy(this.__2dScale),this.__model.position.copy(this.__2dPosition),this.__model.rotation.copy(this.__2dRotation),this.__vrCamera=null,this.__vrCameraAnchor=null,this.__scene=null,this.__model=null,this.__applyFrameOrientation=!0};a.prototype.render=function(a){};e.exports=a}),null);
__d("Asset3dModelVrViewer",["ThreeJS.r88","Asset3dVrController","Asset3dVrViewer"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=.05;c=babelHelpers.inherits(a,b("Asset3dVrViewer"));g=c&&c.prototype;function a(){g.constructor.call(this),this.$Asset3dModelVrViewer1=new(b("Asset3dVrController"))("left","#ff0000","#0000ff",this.$Asset3dModelVrViewer3.bind(this),this.$Asset3dModelVrViewer4.bind(this)),this.$Asset3dModelVrViewer2=new(b("Asset3dVrController"))("right","#00ff00","#0000ff",this.$Asset3dModelVrViewer3.bind(this),this.$Asset3dModelVrViewer4.bind(this))}a.prototype.$Asset3dModelVrViewer4=function(a,b){__p&&__p();if(this.__model)switch(b){case"left":this.__model.rotation.y-=h;break;case"right":this.__model.rotation.y+=h;break;case"up":this.__model.rotation.x-=h;break;case"down":this.__model.rotation.x+=h;break}};a.prototype.$Asset3dModelVrViewer3=function(a){this.__scene&&(a.isValid()?this.__scene.add(a.model()):this.__scene.remove(a.model()))};a.prototype.onEnterVr=function(a,c){this.__onEnterVr(a),c.autoClear=!0,c.vr.autoSubmitFrame=!0,c.setClearColor(new(b("ThreeJS.r88").Color)("white"),1),this.$Asset3dModelVrViewer1.isValid()&&this.__scene.add(this.$Asset3dModelVrViewer1.model()),this.$Asset3dModelVrViewer2.isValid()&&this.__scene.add(this.$Asset3dModelVrViewer2.model()),this.__vrCameraAnchor.matrix.identity(),this.__vrCameraAnchor.applyMatrix(this.__2dCamera.matrixWorld),this.__vrCameraAnchor.updateMatrixWorld()};a.prototype.render=function(a){__p&&__p();if(this.__applyFrameOrientation){this.__applyFrameOrientation=!1;a.vr.getDevice().getFrameData(this.__frameData);if(this.__frameData.pose){if(this.__frameData.pose.position){var c=new(b("ThreeJS.r88").Vector3)();c.fromArray(this.__frameData.pose.position);c.negate();this.__vrCameraAnchor.translateX(c.x);this.__vrCameraAnchor.translateY(c.y);this.__vrCameraAnchor.translateZ(c.z)}this.__vrCameraAnchor.updateMatrixWorld()}}this.$Asset3dModelVrViewer1.render(this.__vrCameraAnchor);this.$Asset3dModelVrViewer2.render(this.__vrCameraAnchor);a.render(this.__scene,this.__vrCamera)};e.exports=a}),null);
__d("Asset3dThreeJsHelpers",["ThreeJS.r88"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={createRoundedCorneredPlane:function(a,c,d){__p&&__p();var e=new(b("ThreeJS.r88").Shape)();e.moveTo(0,d);e.lineTo(0,c-d);e.quadraticCurveTo(0,c,d,c);e.lineTo(a-d,c);e.quadraticCurveTo(a,c,a,c-d);e.lineTo(a,d);e.quadraticCurveTo(a,0,a-d,0);e.lineTo(d,0);e.quadraticCurveTo(0,0,0,d);return new(b("ThreeJS.r88").ShapeBufferGeometry)(e)}};e.exports=a}),null);
__d("Asset3dImageDataURLLoader",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(){this.$1=document.createElement("canvas")}g.getInstance=function(){g.singleAsset3dImageDataURLLoader||(g.singleAsset3dImageDataURLLoader=new g());return g.singleAsset3dImageDataURLLoader};g.prototype.loadHtml=function(a,b,c,d,e){b=g.WORLD_TO_PIXELS*b;c=g.WORLD_TO_PIXELS*c;a='<svg xmlns="http://www.w3.org/2000/svg" background-color="blue" width="'+b+'" height="'+c+'"><foreignObject width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="height:100%;width:100%; xbackground:green;">'+a+"</div></foreignObject></svg>";a=encodeURIComponent(a);d.onload=this.$2.bind(this,d,e,b,c);d.src="data:image/svg+xml,"+a};g.prototype.$2=function(a,b,c,d){var e=this.$1.getContext("2d");this.$1.width=c;this.$1.height=d;e.clearRect(0,0,this.$1.width,this.$1.height);e.drawImage(a,0,0);a.onload=undefined;b(this.$1.toDataURL("image/png"))};g.prototype.loadPicture=function(a,b,c){b.crossOrigin="Anonymous",b.onload=this.$3.bind(this,b,c),b.src=a};g.prototype.$3=function(a,b){var c=this.$1.getContext("2d");this.$1.width=a.width;this.$1.height=a.height;c.clearRect(0,0,this.$1.width,this.$1.height);c.drawImage(a,0,0);a.onload=undefined;b(this.$1.toDataURL("image/png"))};g.WORLD_TO_PIXELS=1024;e.exports=g}),null);
__d("Asset3dVrStoryHeader",["ThreeJS.r88","Asset3dImageDataURLLoader"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=.165;function h(a){this.$1=new(b("ThreeJS.r88").Object3D)(),this.$5=new Image(),this.$8=new Image(),this.$3=a,this.$4=new(b("ThreeJS.r88").Texture)(),this.$4.image=this.$5,this.$4.wrapS=b("ThreeJS.r88").RepeatWrapping,this.$4.wrapT=b("ThreeJS.r88").RepeatWrapping,this.$4.repeat.x=1,this.$4.repeat.y=1,this.$6=new(b("ThreeJS.r88").Mesh)(new(b("ThreeJS.r88").PlaneGeometry)(a,h.maxHeight(),32),new(b("ThreeJS.r88").MeshBasicMaterial)({map:this.$4,transparent:!0})),this.$1.add(this.$6)}h.prototype.model=function(){return this.$1};h.prototype.showStory=function(a){this.$2=a;a=this.$2.owningPictureURI;a&&b("Asset3dImageDataURLLoader").getInstance().loadPicture(a,this.$8,function(a){this.$7=a,this.$9()}.bind(this));this.$9()};h.prototype.height=function(){return this.$2.message?h.maxHeight():h.maxHeight()*.5};h.maxHeight=function(){return g};h.prototype.$9=function(){__p&&__p();var a=h.maxHeight()*b("Asset3dImageDataURLLoader").WORLD_TO_PIXELS;a=a/4;var c=40,d='<div style="height:100%;padding: 10px; font-family:Helvetica, Arial, sans-serif; line-height: '+a+'px">';d+='<div style="height: '+a*2+'px; width: 100%;">';d+='<div style="display:block; float: left; width:'+a*2+"px; height:"+a*2+"px;";this.$7?d+="background-image: url("+this.$7+");":d+="background-color: blue;";d+='background-size:cover;border-radius:50%;">';d+="</div>";d+='<div style="display:block; width:auto; padding-left: '+(a*2+10)+'px; ">';this.$2.title&&(d+='<div style="font-size: '+c+"px; line-height: "+c+'px; white-space:nowrap;">'+this.$2.title+"</div>");this.$2.creationTime&&(d+='<div style="font-size: '+c*.8+"px; line-height: "+c*.9+'white-space:nowrap;">'+this.$2.creationTime+"</div>");d+="</div>";d+="</div>";this.$2.message&&(d+='<div style="font-size: '+c+"px;margin-top: "+a/2+'px; white-space: nowrap; text-overflow:ellipsis;overflow:hidden;">'+this.$2.message+"</div>");d+="</div>";b("Asset3dImageDataURLLoader").getInstance().loadHtml(d,this.$3,h.maxHeight(),this.$5,function(a){this.$5.src=a,this.$4.needsUpdate=!0}.bind(this))};e.exports=h}),null);
__d("Asset3dVrStoryReactions",["invariant","ThreeJS.r88","Asset3dImageDataURLLoader"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=.055;function i(a){this.$1=new(b("ThreeJS.r88").Object3D)(),this.$5=new Image(),this.$3=a,this.$4=new(b("ThreeJS.r88").Texture)(),this.$4.image=this.$5,this.$4.wrapS=b("ThreeJS.r88").RepeatWrapping,this.$4.wrapT=b("ThreeJS.r88").RepeatWrapping,this.$4.repeat.x=1,this.$4.repeat.y=1,this.$6=new(b("ThreeJS.r88").Mesh)(new(b("ThreeJS.r88").PlaneGeometry)(a,i.maxHeight(),32),new(b("ThreeJS.r88").MeshBasicMaterial)({map:this.$4,transparent:!0})),this.$1.add(this.$6)}i.prototype.model=function(){return this.$1};i.prototype.showStory=function(a){this.$2=a,this.$2&&this.$2.supportedReactions&&(this.$7={},this.$2.supportedReactions.forEach(function(a){a.URI&&a.count&&a.count>0&&this.$8.bind(this,a.URI)()}.bind(this))),this.$9()};i.prototype.hasContentToDisplay=function(){var a=this.$2;return a?a.reactionsText!==null:!1};i.prototype.height=function(){return i.maxHeight()};i.maxHeight=function(){return h};i.prototype.$8=function(a){var c=new Image();b("Asset3dImageDataURLLoader").getInstance().loadPicture(a,c,function(b){this.$7[a]=b,this.$9()}.bind(this))};i.prototype.$9=function(){__p&&__p();if(!this.hasContentToDisplay())this.$6.visible=!1;else{this.$2&&this.$2.reactionsText||g(0);this.$6.visible=!0;var a=40,c='<div style="height:100%;padding: 10px; font-family:Helvetica, Arial, sans-serif; ">';if(this.$2.supportedReactions){c+='<div style="display:inline-block;padding-right:20px">';var d=3,e=Object.keys(this.$7);for(var f=0;f<e.length&&f<d;f++){var h=e[f];h=this.$7[h];c+='<div style="border:2px solid white;display:inline-block;position:relative;margin-right:-10px;width:'+a+"px; height:"+a+"px;";c+="z-index: "+(e.length-f)+";";c+="background-image: url("+h+");";c+='background-size:cover;border-radius:50%;"></div>'}c+="</div>"}h=this.$2.reactionsText;h&&(c+='<div style="display:inline-block;font-size: '+a+'px; white-space: nowrap; text-overflow:ellipsis;overflow:hidden;">'+h+"</div>");c+="</div>";b("Asset3dImageDataURLLoader").getInstance().loadHtml(c,this.$3,i.maxHeight(),this.$5,function(a){this.$5.src=a,this.$4.needsUpdate=!0}.bind(this))}};e.exports=i}),null);
__d("Asset3dVrStory",["invariant","ThreeJS.r88","Asset3dVrStoryHeader","Asset3dVrStoryReactions","Asset3dThreeJsHelpers"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=.015,i=.025;function a(a,c){__p&&__p();this.$5=a;var d=new(b("ThreeJS.r88").Vector3)();c.getSize(d);this.$1=new(b("ThreeJS.r88").Object3D)();this.$2=new(b("Asset3dVrStoryHeader"))(d.x);this.$3=new(b("Asset3dVrStoryReactions"))(d.x);c=d.x+4*h;var e=d.y+b("Asset3dVrStoryHeader").maxHeight()+b("Asset3dVrStoryReactions").maxHeight()+4*h;this.$4=d.y;var f=new(b("ThreeJS.r88").Mesh)(b("Asset3dThreeJsHelpers").createRoundedCorneredPlane(c,e,i),new(b("ThreeJS.r88").MeshBasicMaterial)({color:new(b("ThreeJS.r88").Color)("white"),colorWrite:!0,depthWrite:!1}));this.$1.add(f);var g=this.$2.model();g.translateY(e-h-b("Asset3dVrStoryHeader").maxHeight()/2);g.translateX(h+d.x/2);f.add(g);e=this.$3.model();e.translateX(h+d.x/2);e.translateY(h+b("Asset3dVrStoryReactions").maxHeight()/2);f.add(e);this.$1.position.copy(a);this.$1.translateY(-(b("Asset3dVrStoryReactions").maxHeight()+2*h));this.$1.position.x+=-(c-d.x)/2}a.prototype.model=function(){return this.$1};a.prototype.showStory=function(a){__p&&__p();a.header||g(0);this.$2.showStory(a.header);this.$3.showStory(a.reactions);a=0;this.$3.hasContentToDisplay()&&(a=h+this.$3.height());var c=this.$4+3*h+this.$2.height()+a,d=this.$4+b("Asset3dVrStoryHeader").maxHeight()+b("Asset3dVrStoryReactions").maxHeight()+4*h;a=h+a;this.$1.scale.y=c/d;this.$1.position.y=this.$5.y;this.$1.translateY(-a)};e.exports=a}),null);
__d("Asset3dPhotoVrViewer",["ThreeJS.r88","Asset3dVrViewer","Asset3dVrStory","Asset3dThreeJsHelpers"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=.3,i=.4,j=[2.5,2.5,1],k=.0125,l=[-h*j[0]/2,-.25,-1],m=[1.75,1.75,1.75],n=[0,-.1,.9],o=12501961,p=15922165;c=babelHelpers.inherits(a,b("Asset3dVrViewer"));g=c&&c.prototype;function a(){g.constructor.call(this),this.$Asset3dPhotoVrViewer6()}a.prototype.$Asset3dPhotoVrViewer6=function(){__p&&__p();this.$Asset3dPhotoVrViewer1=new(b("ThreeJS.r88").Object3D)();this.$Asset3dPhotoVrViewer1.position.fromArray(l);this.$Asset3dPhotoVrViewer1.scale.fromArray(j);this.$Asset3dPhotoVrViewer4=new(b("ThreeJS.r88").Scene)();this.$Asset3dPhotoVrViewer4.add(this.$Asset3dPhotoVrViewer1);this.$Asset3dPhotoVrViewer2=new(b("ThreeJS.r88").Mesh)(b("Asset3dThreeJsHelpers").createRoundedCorneredPlane(h,i,k),new(b("ThreeJS.r88").MeshBasicMaterial)({stencilWrite:!0,colorWrite:!0,color:p,depthWrite:!1}));this.$Asset3dPhotoVrViewer2.position.copy(this.$Asset3dPhotoVrViewer1.position);this.$Asset3dPhotoVrViewer2.scale.copy(this.$Asset3dPhotoVrViewer1.scale);this.$Asset3dPhotoVrViewer2.translateY(-i);this.$Asset3dPhotoVrViewer3=new(b("ThreeJS.r88").Scene)();this.$Asset3dPhotoVrViewer3.add(this.$Asset3dPhotoVrViewer2);var a=new(b("ThreeJS.r88").Box3)().setFromObject(this.$Asset3dPhotoVrViewer2);this.$Asset3dPhotoVrViewer5=new(b("Asset3dVrStory"))(this.$Asset3dPhotoVrViewer2.position,a);this.$Asset3dPhotoVrViewer4.add(this.$Asset3dPhotoVrViewer5.model())};a.prototype.onEnterVr=function(a,c){this.__onEnterVr(a),this.$Asset3dPhotoVrViewer5.showStory(this.__storyProps),c.autoClear=!1,c.vr.autoSubmitFrame=!1,c.setClearColor(new(b("ThreeJS.r88").Color)(o),1),this.__model.scale.fromArray(m),this.__model.position.fromArray(n)};a.prototype.onExitVr=function(){this.__onExitVr()};a.prototype.render=function(a){__p&&__p();if(this.__applyFrameOrientation){this.__applyFrameOrientation=!1;a.vr.getDevice().getFrameData(this.__frameData);if(this.__frameData.pose){if(this.__frameData.pose.orientation){var c=new(b("ThreeJS.r88").Quaternion)();c.fromArray(this.__frameData.pose.orientation);var d=new(b("ThreeJS.r88").Euler)();d.setFromQuaternion(c,"YXZ");this.__vrCameraAnchor.rotation.y=-d.y;this.__vrCameraAnchor.updateMatrixWorld()}if(this.__frameData.pose.position){c=new(b("ThreeJS.r88").Vector3)();c.fromArray(this.__frameData.pose.position);this.__vrCameraAnchor.position.copy(c.negate());this.__vrCameraAnchor.updateMatrixWorld()}}}d=a.state.buffers.stencil;c=a.state.buffers.depth;var e=a.context;a.clearColor();c.setTest(!0);d.setTest(!0);d.setFunc(e.ALWAYS,1,255);d.setOp(e.REPLACE,e.REPLACE,e.REPLACE);a.render(this.$Asset3dPhotoVrViewer3,this.__vrCamera);a.clearDepth();d.setFunc(e.EQUAL,1,255);d.setOp(e.KEEP,e.KEEP,e.KEEP);a.render(this.__scene,this.__vrCamera);d.setFunc(e.NOTEQUAL,1,255);d.setOp(e.KEEP,e.KEEP,e.KEEP);c.setTest(!1);a.render(this.$Asset3dPhotoVrViewer4,this.__vrCamera);a.clearStencil();a.clearDepth();a.vr.submitFrame()};e.exports=a}),null);
__d("Asset3dVrManager",["invariant","Promise","ThreeJS.r88","promiseDone","Asset3dVrViewer","Asset3dModelVrViewer","Asset3dPhotoVrViewer","Asset3DCategory"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(a){this.$6=[],this.$13=function(){var a=this.$1;this.inVr()&&a&&(this.$4.requestAnimationFrame(this.$13),a.render(this.$5))}.bind(this),this.$5=a,this.$8(),window.addEventListener("vrdisplayconnect",function(){this.$8()}.bind(this)),window.addEventListener("vrdisplaydisconnect",function(){this.$8()}.bind(this)),document.addEventListener("visibilitychange",function(){document.visibilityState!=="visible"&&b("promiseDone")(this.exitVr())}.bind(this)),window.addEventListener("vrdisplaypresentchange",function(){this.$4.isPresenting?this.$9():this.$10()}.bind(this))}a.prototype.addDeviceReadyListner=function(a){this.$6.push(a),a(this.$4!==null)};a.prototype.removeDeviceReadyListner=function(a){a=this.$6.indexOf(a);a>=0&&this.$6.splice(a,1)};a.prototype.$11=function(){this.$6.forEach(function(a){a(this.$4!==null)}.bind(this))};a.prototype.$8=function(){this.$4=null,navigator.getVRDisplays&&b("promiseDone")(b("Promise").resolve(navigator.getVRDisplays().then(function(a){a.length>0&&(this.$4=a[0],this.$2||(this.$2=new(b("Asset3dModelVrViewer"))()),this.$3||(this.$3=new(b("Asset3dPhotoVrViewer"))())),this.$5.vr.setDevice(this.$4),this.$11()}.bind(this))))};a.prototype.$12=function(a){if(a===b("Asset3DCategory").PHOTOS_3D){this.$3||g(0);return this.$3}else{this.$2||g(0);return this.$2}};a.prototype.enterVr=function(a,c,d,e,f){__p&&__p();if(this.$4){if(this.$4.isPresenting){this.$10();this.$1=this.$12(a);this.$1.setup(c,d,f);this.$7=e;this.$9();return b("Promise").resolve()}this.$1=this.$12(a);this.$1.setup(c,d,f);this.$7=e;return b("Promise").resolve(this.$4.requestPresent([{source:this.$5.domElement}]))}return b("Promise").resolve()};a.prototype.$9=function(){var a=this.$1;a&&(a.onEnterVr(this.$4,this.$5),this.$5.vr.enabled=!0,this.$4.requestAnimationFrame(this.$13))};a.prototype.exitVr=function(){return this.$4&&this.$4.isPresenting?b("Promise").resolve(this.$4.exitPresent()):b("Promise").resolve()};a.prototype.$10=function(){var a=this.$1;a&&(this.$4.cancelAnimationFrame(this.$13),this.$5.vr.enabled=!1,a.onExitVr(),this.$1=null,this.$7&&(this.$7(),this.$7=null))};a.prototype.domElement=function(){return this.$5.domElement};a.prototype.inVr=function(){return this.$4&&this.$4.isPresenting};e.exports=a}),null);
__d("GLTFLoader.r88",["Promise","ThreeJS.r88"],(function(a,b,c,d,e,f){__p&&__p();GLTFLoader=function(){__p&&__p();function a(a){this.manager=a!==undefined?a:b("ThreeJS.r88").DefaultLoadingManager}a.prototype={constructor:a,crossOrigin:"Anonymous",load:function(a,c,d,e){var f=this,g=this.path!==undefined?this.path:b("ThreeJS.r88").Loader.prototype.extractUrlBase(a),h=new(b("ThreeJS.r88").FileLoader)(f.manager);h.setResponseType("arraybuffer");h.load(a,function(a){try{f.parse(a,g,c,e)}catch(a){e!==undefined&&e(a.constructor===Error?a:new Error("THREE.GLTFLoader: Unable to parse model."))}},d,e)},setCrossOrigin:function(a){this.crossOrigin=a},setPath:function(a){this.path=a},parse:function(a,b,c,i){__p&&__p();var j,m={};if(typeof a==="string")j=a;else{var n=y(new Uint8Array(a,0,4));n===h?(m[d.KHR_BINARY_GLTF]=new k(a),j=m[d.KHR_BINARY_GLTF].content):j=y(new Uint8Array(a))}n=JSON.parse(j);if(n.asset===undefined||n.asset.version[0]<2){i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}n.extensionsUsed&&(n.extensionsUsed.indexOf(d.KHR_LIGHTS)>=0&&(m[d.KHR_LIGHTS]=new e(n)),n.extensionsUsed.indexOf(d.KHR_MATERIALS_COMMON)>=0&&(m[d.KHR_MATERIALS_COMMON]=new f(n)),n.extensionsUsed.indexOf(d.KHR_MATERIALS_UNLIT)>=0&&(m[d.KHR_MATERIALS_UNLIT]=new g(n)),n.extensionsUsed.indexOf(d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS)>=0&&(m[d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]=new l()));console.time("GLTFLoader");a=new B(n,m,{path:b||this.path||"",crossOrigin:this.crossOrigin,manager:this.manager});a.parse(function(a,b,d,e){console.timeEnd("GLTFLoader");a={scene:a,scenes:b,cameras:d,animations:e};c(a)},i)}};function c(){var a={};return{get:function(b){return a[b]},add:function(b,c){a[b]=c},remove:function(b){delete a[b]},removeAll:function(){a={}}}}var d={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_LIGHTS:"KHR_lights",KHR_MATERIALS_COMMON:"KHR_materials_common",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness"};function e(a){__p&&__p();this.name=d.KHR_LIGHTS;this.lights={};a=a.extensions&&a.extensions[d.KHR_LIGHTS]||{};a=a.lights||{};for(var c in a){var e=a[c],f,g=new(b("ThreeJS.r88").Color)().fromArray(e.color);switch(e.type){case"directional":f=new(b("ThreeJS.r88").DirectionalLight)(g);f.position.set(0,0,1);break;case"point":f=new(b("ThreeJS.r88").PointLight)(g);break;case"spot":f=new(b("ThreeJS.r88").SpotLight)(g);f.position.set(0,0,1);break;case"ambient":f=new(b("ThreeJS.r88").AmbientLight)(g);break}f&&(e.constantAttenuation!==undefined&&(f.intensity=e.constantAttenuation),e.linearAttenuation!==undefined&&(f.distance=1/e.linearAttenuation),e.quadraticAttenuation!==undefined&&(f.decay=e.quadraticAttenuation),e.fallOffAngle!==undefined&&(f.angle=e.fallOffAngle),e.fallOffExponent!==undefined&&!1,f.name=e.name||"light_"+c,this.lights[c]=f)}}function f(a){this.name=d.KHR_MATERIALS_COMMON}f.prototype.getMaterialType=function(a){a=a.extensions[this.name];switch(a.type){case"commonBlinn":case"commonPhong":return b("ThreeJS.r88").MeshPhongMaterial;case"commonLambert":return b("ThreeJS.r88").MeshLambertMaterial;case"commonConstant":default:return b("ThreeJS.r88").MeshBasicMaterial}};f.prototype.extendParams=function(a,c,d){__p&&__p();var e=c.extensions[this.name];c=[];var f=[];switch(e.type){case"commonBlinn":case"commonPhong":f.push("diffuseFactor","diffuseTexture","specularFactor","specularTexture","shininessFactor");break;case"commonLambert":f.push("diffuseFactor","diffuseTexture");break;case"commonConstant":default:break}var g={};f.forEach(function(a){e[a]!==undefined&&(g[a]=e[a])});g.diffuseFactor!==undefined&&(a.color=new(b("ThreeJS.r88").Color)().fromArray(g.diffuseFactor),a.opacity=g.diffuseFactor[3]);g.diffuseTexture!==undefined&&c.push(d.assignTexture(a,"map",g.diffuseTexture.index));g.specularFactor!==undefined&&(a.specular=new(b("ThreeJS.r88").Color)().fromArray(g.specularFactor));g.specularTexture!==undefined&&c.push(d.assignTexture(a,"specularMap",g.specularTexture.index));g.shininessFactor!==undefined&&(a.shininess=g.shininessFactor);return b("Promise").all(c)};function g(a){this.name=d.KHR_MATERIALS_UNLIT}g.prototype.getMaterialType=function(a){return b("ThreeJS.r88").MeshBasicMaterial};g.prototype.extendParams=function(a,c,d){__p&&__p();var e=[];delete c.emissiveFactor;delete c.emissiveTexture;a.color=new(b("ThreeJS.r88").Color)(1,1,1);a.opacity=1;c=c.pbrMetallicRoughness;if(c!==undefined){if(Array.isArray(c.baseColorFactor)){var f=c.baseColorFactor;a.color.fromArray(f);a.opacity=f[3]}c.baseColorTexture!==undefined&&e.push(d.assignTexture(a,"map",c.baseColorTexture.index))}return b("Promise").all(e)};var h="glTF",i=12,j={JSON:1313821514,BIN:5130562};function k(a){__p&&__p();this.name=d.KHR_BINARY_GLTF;this.content=null;this.body=null;var b=new DataView(a,0,i);this.header={magic:y(new Uint8Array(a.slice(0,4))),version:b.getUint32(4,!0),length:b.getUint32(8,!0)};if(this.header.magic!==h)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");else if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use GLTFLoader instead.");b=new DataView(a,i);var c=0;while(c<b.byteLength){var e=b.getUint32(c,!0);c+=4;var f=b.getUint32(c,!0);c+=4;if(f===j.JSON){var g=new Uint8Array(a,i+c,e);this.content=y(g)}else if(f===j.BIN){g=i+c;this.body=a.slice(g,g+e)}c+=e}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}function l(){__p&&__p();return{name:d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return b("ThreeJS.r88").ShaderMaterial},extendParams:function(a,c,d){__p&&__p();c=c.extensions[this.name];var e=b("ThreeJS.r88").ShaderLib.standard,f=b("ThreeJS.r88").UniformsUtils.clone(e.uniforms),g=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),h=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),j=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),k=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n");g=e.fragmentShader.replace("#include <specularmap_fragment>","").replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",g).replace("#include <metalnessmap_pars_fragment>",h).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",j).replace("#include <lights_physical_fragment>",k);delete f.roughness;delete f.metalness;delete f.roughnessMap;delete f.metalnessMap;f.specular={value:new(b("ThreeJS.r88").Color)().setHex(1118481)};f.glossiness={value:.5};f.specularMap={value:null};f.glossinessMap={value:null};a.vertexShader=e.vertexShader;a.fragmentShader=g;a.uniforms=f;a.defines={STANDARD:""};a.color=new(b("ThreeJS.r88").Color)(1,1,1);a.opacity=1;h=[];if(Array.isArray(c.diffuseFactor)){i=c.diffuseFactor;a.color.fromArray(i);a.opacity=i[3]}c.diffuseTexture!==undefined&&h.push(d.assignTexture(a,"map",c.diffuseTexture.index));a.emissive=new(b("ThreeJS.r88").Color)(0,0,0);a.glossiness=c.glossinessFactor!==undefined?c.glossinessFactor:1;a.specular=new(b("ThreeJS.r88").Color)(1,1,1);Array.isArray(c.specularFactor)&&a.specular.fromArray(c.specularFactor);if(c.specularGlossinessTexture!==undefined){j=c.specularGlossinessTexture.index;h.push(d.assignTexture(a,"glossinessMap",j));h.push(d.assignTexture(a,"specularMap",j))}return b("Promise").all(h)},createMaterial:function(a){__p&&__p();var c=new(b("ThreeJS.r88").ShaderMaterial)({defines:a.defines,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,uniforms:a.uniforms,fog:!0,lights:!0,opacity:a.opacity,transparent:a.transparent});c.isGLTFSpecularGlossinessMaterial=!0;c.color=a.color;c.map=a.map===undefined?null:a.map;c.lightMap=null;c.lightMapIntensity=1;c.aoMap=a.aoMap===undefined?null:a.aoMap;c.aoMapIntensity=1;c.emissive=a.emissive;c.emissiveIntensity=1;c.emissiveMap=a.emissiveMap===undefined?null:a.emissiveMap;c.bumpMap=a.bumpMap===undefined?null:a.bumpMap;c.bumpScale=1;c.normalMap=a.normalMap===undefined?null:a.normalMap;a.normalScale&&(c.normalScale=a.normalScale);c.displacementMap=null;c.displacementScale=1;c.displacementBias=0;c.specularMap=a.specularMap===undefined?null:a.specularMap;c.specular=a.specular;c.glossinessMap=a.glossinessMap===undefined?null:a.glossinessMap;c.glossiness=a.glossiness;c.alphaMap=null;c.envMap=a.envMap===undefined?null:a.envMap;c.envMapIntensity=1;c.refractionRatio=.98;c.extensions.derivatives=!0;return c},cloneMaterial:function(a){var b=a.clone();b.isGLTFSpecularGlossinessMaterial=!0;var c=this.specularGlossinessParams;for(var d=0;d<c.length;d++)b[c[d]]=a[c[d]];return b},refreshUniforms:function(a,b,c,d,e,f){__p&&__p();a=e.uniforms;b=e.defines;a.opacity.value=e.opacity;a.diffuse.value.copy(e.color);a.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity);a.map.value=e.map;a.specularMap.value=e.specularMap;a.alphaMap.value=e.alphaMap;a.lightMap.value=e.lightMap;a.lightMapIntensity.value=e.lightMapIntensity;a.aoMap.value=e.aoMap;a.aoMapIntensity.value=e.aoMapIntensity;var g;e.map?g=e.map:e.specularMap?g=e.specularMap:e.displacementMap?g=e.displacementMap:e.normalMap?g=e.normalMap:e.bumpMap?g=e.bumpMap:e.glossinessMap?g=e.glossinessMap:e.alphaMap?g=e.alphaMap:e.emissiveMap&&(g=e.emissiveMap);if(g!==undefined){g.isWebGLRenderTarget&&(g=g.texture);if(g.matrix!==undefined){if(g.matrixAutoUpdate===!0){c=g.offset;d=g.repeat;f=g.rotation;var h=g.center;g.matrix.setUvTransform(c.x,c.y,d.x,d.y,f,h.x,h.y)}a.uvTransform.value.copy(g.matrix)}else c=g.offset,d=g.repeat,a.offsetRepeat.value.set(c.x,c.y,d.x,d.y)}a.envMap.value=e.envMap;a.envMapIntensity.value=e.envMapIntensity;a.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1;a.refractionRatio.value=e.refractionRatio;a.specular.value.copy(e.specular);a.glossiness.value=e.glossiness;a.glossinessMap.value=e.glossinessMap;a.emissiveMap.value=e.emissiveMap;a.bumpMap.value=e.bumpMap;a.normalMap.value=e.normalMap;a.displacementMap.value=e.displacementMap;a.displacementScale.value=e.displacementScale;a.displacementBias.value=e.displacementBias;a.glossinessMap.value!==null&&b.USE_GLOSSINESSMAP===undefined&&(b.USE_GLOSSINESSMAP="",b.USE_ROUGHNESSMAP="");a.glossinessMap.value===null&&b.USE_GLOSSINESSMAP!==undefined&&(delete b.USE_GLOSSINESSMAP,delete b.USE_ROUGHNESSMAP)}}}var m={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123};({5126:Number,35675:b("ThreeJS.r88").Matrix3,35676:b("ThreeJS.r88").Matrix4,35664:b("ThreeJS.r88").Vector2,35665:b("ThreeJS.r88").Vector3,35666:b("ThreeJS.r88").Vector4,35678:b("ThreeJS.r88").Texture});var n={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},o={9728:b("ThreeJS.r88").NearestFilter,9729:b("ThreeJS.r88").LinearFilter,9984:b("ThreeJS.r88").NearestMipMapNearestFilter,9985:b("ThreeJS.r88").LinearMipMapNearestFilter,9986:b("ThreeJS.r88").NearestMipMapLinearFilter,9987:b("ThreeJS.r88").LinearMipMapLinearFilter},p={33071:b("ThreeJS.r88").ClampToEdgeWrapping,33648:b("ThreeJS.r88").MirroredRepeatWrapping,10497:b("ThreeJS.r88").RepeatWrapping},q={6406:b("ThreeJS.r88").AlphaFormat,6407:b("ThreeJS.r88").RGBFormat,6408:b("ThreeJS.r88").RGBAFormat,6409:b("ThreeJS.r88").LuminanceFormat,6410:b("ThreeJS.r88").LuminanceAlphaFormat},r={5121:b("ThreeJS.r88").UnsignedByteType,32819:b("ThreeJS.r88").UnsignedShort4444Type,32820:b("ThreeJS.r88").UnsignedShort5551Type,33635:b("ThreeJS.r88").UnsignedShort565Type};({1028:b("ThreeJS.r88").BackSide,1029:b("ThreeJS.r88").FrontSide});({512:b("ThreeJS.r88").NeverDepth,513:b("ThreeJS.r88").LessDepth,514:b("ThreeJS.r88").EqualDepth,515:b("ThreeJS.r88").LessEqualDepth,516:b("ThreeJS.r88").GreaterEqualDepth,517:b("ThreeJS.r88").NotEqualDepth,518:b("ThreeJS.r88").GreaterEqualDepth,519:b("ThreeJS.r88").AlwaysDepth});({32774:b("ThreeJS.r88").AddEquation,32778:b("ThreeJS.r88").SubtractEquation,32779:b("ThreeJS.r88").ReverseSubtractEquation});({0:b("ThreeJS.r88").ZeroFactor,1:b("ThreeJS.r88").OneFactor,768:b("ThreeJS.r88").SrcColorFactor,769:b("ThreeJS.r88").OneMinusSrcColorFactor,770:b("ThreeJS.r88").SrcAlphaFactor,771:b("ThreeJS.r88").OneMinusSrcAlphaFactor,772:b("ThreeJS.r88").DstAlphaFactor,773:b("ThreeJS.r88").OneMinusDstAlphaFactor,774:b("ThreeJS.r88").DstColorFactor,775:b("ThreeJS.r88").OneMinusDstColorFactor,776:b("ThreeJS.r88").SrcAlphaSaturateFactor});var s={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},t={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},u={CATMULLROMSPLINE:b("ThreeJS.r88").InterpolateSmooth,CUBICSPLINE:b("ThreeJS.r88").InterpolateSmooth,LINEAR:b("ThreeJS.r88").InterpolateLinear,STEP:b("ThreeJS.r88").InterpolateDiscrete};({2884:"CULL_FACE",2929:"DEPTH_TEST",3042:"BLEND",3089:"SCISSOR_TEST",32823:"POLYGON_OFFSET_FILL",32926:"SAMPLE_ALPHA_TO_COVERAGE"});var v={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function w(a,c,d){__p&&__p();if(!a)return b("Promise").resolve();var e,f=[];if(Object.prototype.toString.call(a)==="[object Array]"){e=[];var g=a.length;for(var h=0;h<g;h++){var i=c.call(d||this,a[h],h);i&&(i instanceof b("Promise")?i=i.then(function(b,a){e[b]=a}.bind(this,h)):e[h]=i,f.push(i))}}else{e={};for(var j in a)if(Object.prototype.hasOwnProperty.call(a,j)){var i=c.call(d||this,a[j],j);i&&(i instanceof b("Promise")?i=i.then(function(b,a){e[b]=a}.bind(this,j)):e[j]=i,f.push(i))}}return b("Promise").all(f).then(function(){return e})}function x(a,b){if(typeof a!=="string"||a==="")return"";if(/^(https?:)?\/\//i.test(a))return a;if(/^data:.*,.*$/i.test(a))return a;return/^blob:.*$/i.test(a)?a:b+a}function y(a){if(window.TextDecoder!==undefined)return new TextDecoder().decode(a);var b="";for(var c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);return b}function z(){return new(b("ThreeJS.r88").MeshStandardMaterial)({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:b("ThreeJS.r88").FrontSide})}function A(a,b,c,d){__p&&__p();var e=a.geometry,f=a.material;c=c.targets;var g=e.morphAttributes;g.position=[];g.normal=[];f.morphTargets=!0;for(var h=0,i=c.length;h<i;h++){var j=c[h],k="morphTarget"+h,l,m;if(j.POSITION!==undefined){l=d.accessors[j.POSITION].clone();var n=e.attributes.position;for(var o=0,p=l.count;o<p;o++)l.setXYZ(o,l.getX(o)+n.getX(o),l.getY(o)+n.getY(o),l.getZ(o)+n.getZ(o))}else e.attributes.position&&(l=e.attributes.position.clone());l!==undefined&&(l.name=k,g.position.push(l));if(j.NORMAL!==undefined){f.morphNormals=!0;m=d.accessors[j.NORMAL].clone();n=e.attributes.normal;for(var o=0,p=m.count;o<p;o++)m.setXYZ(o,m.getX(o)+n.getX(o),m.getY(o)+n.getY(o),m.getZ(o)+n.getZ(o))}else e.attributes.normal!==undefined&&(m=e.attributes.normal.clone());m!==undefined&&(m.name=k,g.normal.push(m))}a.updateMorphTargets();if(b.weights!==undefined)for(var h=0,i=b.weights.length;h<i;h++)a.morphTargetInfluences[h]=b.weights[h]}function B(a,d,e){this.json=a||{},this.extensions=d||{},this.options=e||{},this.cache=new c(),this.textureLoader=new(b("ThreeJS.r88").TextureLoader)(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new(b("ThreeJS.r88").FileLoader)(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}B.prototype._withDependencies=function(a){__p&&__p();var b={};for(var c=0;c<a.length;c++){var d=a[c],e="load"+d.charAt(0).toUpperCase()+d.slice(1),f=this.cache.get(d);if(f!==undefined)b[d]=f;else if(this[e]){f=this[e]();this.cache.add(d,f);b[d]=f}}return w(b,function(a){return a})};B.prototype.parse=function(a,b){var c=this.json,d=this;this.cache.removeAll();this._withDependencies(["scenes","animations"]).then(function(e){var f=e.scenes||[],g=f[c.scene||0],h=e.animations||[];d.getDependencies("camera").then(function(b){a(g,f,b,h)})["catch"](b)})["catch"](b)};B.prototype.getDependency=function(a,b){var c=a+":"+b,d=this.cache.get(c);if(!d){a="load"+a.charAt(0).toUpperCase()+a.slice(1);d=this[a](b);this.cache.add(c,d)}return d};B.prototype.getDependencies=function(a){var c=this,d=this.json[a+"s"]||[];return b("Promise").all(d.map(function(b,d){return c.getDependency(a,d)}))};B.prototype.loadBuffer=function(a){var c=this.json.buffers[a],e=this.fileLoader;if(c.type&&c.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+c.type+" buffer type is not supported.");if(c.uri===undefined&&a===0)return b("Promise").resolve(this.extensions[d.KHR_BINARY_GLTF].body);var f=this.options;return new(b("Promise"))(function(a,b){e.load(x(c.uri,f.path),a,undefined,function(){b(new Error('THREE.GLTFLoader: Failed to load buffer "'+c.uri+'".'))})})};B.prototype.loadBufferView=function(a){var b=this.json.bufferViews[a];return this.getDependency("buffer",b.buffer).then(function(a){var c=b.byteLength||0,d=b.byteOffset||0;return a.slice(d,d+c)})};B.prototype.loadAccessors=function(){__p&&__p();var a=this,c=this.json;return w(c.accessors,function(d){__p&&__p();return a.getDependency("bufferView",d.bufferView).then(function(a){var e=s[d.type],f=n[d.componentType],g=f.BYTES_PER_ELEMENT,h=g*e,i=c.bufferViews[d.bufferView].byteStride,j=d.normalized===!0;if(i&&i!==h){h=new f(a);i=new(b("ThreeJS.r88").InterleavedBuffer)(h,i/g);return new(b("ThreeJS.r88").InterleavedBufferAttribute)(i,e,d.byteOffset/g,j)}else{h=new f(a,d.byteOffset,d.count*e);return new(b("ThreeJS.r88").BufferAttribute)(h,e,j)}})})};B.prototype.loadTexture=function(a){__p&&__p();var c=this,d=this.json,e=this.options,f=this.textureLoader,g=window.URL||window.webkitURL,h=d.textures[a],i=d.images[h.source],j=i.uri,k=!1;i.bufferView!==undefined&&(j=c.getDependency("bufferView",i.bufferView).then(function(a){k=!0;a=new Blob([a],{type:i.mimeType});j=g.createObjectURL(a);return j}));return b("Promise").resolve(j).then(function(a){var c=b("ThreeJS.r88").Loader.Handlers.get(a)||f;return new(b("Promise"))(function(b,d){c.load(x(a,e.path),b,undefined,d)})}).then(function(a){__p&&__p();k===!0&&g.revokeObjectURL(j);a.flipY=!1;h.name!==undefined&&(a.name=h.name);a.format=h.format!==undefined?q[h.format]:b("ThreeJS.r88").RGBAFormat;h.internalFormat!==undefined&&a.format!==q[h.internalFormat]&&!1;a.type=h.type!==undefined?r[h.type]:b("ThreeJS.r88").UnsignedByteType;var c=d.samplers||{};c=c[h.sampler]||{};a.magFilter=o[c.magFilter]||b("ThreeJS.r88").LinearFilter;a.minFilter=o[c.minFilter]||b("ThreeJS.r88").LinearMipMapLinearFilter;a.wrapS=p[c.wrapS]||b("ThreeJS.r88").RepeatWrapping;a.wrapT=p[c.wrapT]||b("ThreeJS.r88").RepeatWrapping;return a})};B.prototype.assignTexture=function(a,b,c){return this.getDependency("texture",c).then(function(c){a[b]=c})};B.prototype.loadMaterials=function(){__p&&__p();var a=this,c=this.json,e=this.extensions;return w(c.materials,function(c){__p&&__p();var f,g={},h=c.extensions||{},i=[];if(h[d.KHR_MATERIALS_UNLIT]){var j=e[d.KHR_MATERIALS_UNLIT];f=j.getMaterialType(c);i.push(j.extendParams(g,c,a))}else if(h[d.KHR_MATERIALS_COMMON]){j=e[d.KHR_MATERIALS_COMMON];f=j.getMaterialType(c);i.push(j.extendParams(g,c,a))}else if(c.pbrMetallicRoughness!==undefined){f=b("ThreeJS.r88").MeshStandardMaterial;h=c.pbrMetallicRoughness;g.color=new(b("ThreeJS.r88").Color)(1,1,1);g.opacity=1;if(Array.isArray(h.baseColorFactor)){j=h.baseColorFactor;g.color.fromArray(j);g.opacity=j[3]}h.baseColorTexture!==undefined&&i.push(a.assignTexture(g,"map",h.baseColorTexture.index));g.metalness=h.metallicFactor!==undefined?h.metallicFactor:1;g.roughness=h.roughnessFactor!==undefined?h.roughnessFactor:1;if(h.metallicRoughnessTexture!==undefined){j=h.metallicRoughnessTexture.index;i.push(a.assignTexture(g,"metalnessMap",j));i.push(a.assignTexture(g,"roughnessMap",j))}}else f=b("ThreeJS.r88").MeshPhongMaterial;c.doubleSided===!0&&(g.side=b("ThreeJS.r88").DoubleSide);h=c.alphaMode||v.OPAQUE;h!==v.OPAQUE?(g.transparent=!0,h===v.MASK&&(g.alphaTest=c.alphaCutoff||.5)):g.transparent=!1;c.normalTexture!==undefined&&(i.push(a.assignTexture(g,"normalMap",c.normalTexture.index)),g.normalScale=new(b("ThreeJS.r88").Vector2)(1,1),c.normalTexture.scale!==undefined&&g.normalScale.set(c.normalTexture.scale,c.normalTexture.scale));c.occlusionTexture!==undefined&&(i.push(a.assignTexture(g,"aoMap",c.occlusionTexture.index)),c.occlusionTexture.strength!==undefined&&(g.aoMapIntensity=c.occlusionTexture.strength));c.emissiveFactor!==undefined&&(f===b("ThreeJS.r88").MeshBasicMaterial?g.color=new(b("ThreeJS.r88").Color)().fromArray(c.emissiveFactor):g.emissive=new(b("ThreeJS.r88").Color)().fromArray(c.emissiveFactor));c.emissiveTexture!==undefined&&(f===b("ThreeJS.r88").MeshBasicMaterial?i.push(a.assignTexture(g,"map",c.emissiveTexture.index)):i.push(a.assignTexture(g,"emissiveMap",c.emissiveTexture.index)));return b("Promise").all(i).then(function(){var a;f===b("ThreeJS.r88").ShaderMaterial?a=e[d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(g):a=new f(g);c.name!==undefined&&(a.name=c.name);a.normalScale&&(a.normalScale.x=-a.normalScale.x);a.map&&(a.map.encoding=b("ThreeJS.r88").sRGBEncoding);a.emissiveMap&&(a.emissiveMap.encoding=b("ThreeJS.r88").sRGBEncoding);c.extras&&(a.userData=c.extras);return a})})};B.prototype.loadGeometries=function(a){__p&&__p();return this._withDependencies(["accessors"]).then(function(c){__p&&__p();return w(a,function(a){__p&&__p();var d=new(b("ThreeJS.r88").BufferGeometry)(),e=a.attributes;for(var f in e){var g=e[f];if(g===undefined)return;g=c.accessors[g];switch(f){case"POSITION":d.addAttribute("position",g);break;case"NORMAL":d.addAttribute("normal",g);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":d.addAttribute("uv",g);break;case"TEXCOORD_1":d.addAttribute("uv2",g);break;case"COLOR_0":case"COLOR0":case"COLOR":d.addAttribute("color",g);break;case"WEIGHTS_0":case"WEIGHT":d.addAttribute("skinWeight",g);break;case"JOINTS_0":case"JOINT":d.addAttribute("skinIndex",g);break}}a.indices!==undefined&&d.setIndex(c.accessors[a.indices]);return d})})};B.prototype.loadMeshes=function(){__p&&__p();var a=this,c=this.json,e=this.extensions;return this._withDependencies(["accessors","materials"]).then(function(f){__p&&__p();return w(c.meshes,function(c,g){__p&&__p();var h=new(b("ThreeJS.r88").Group)(),i=c.primitives||[];return a.loadGeometries(i).then(function(a){__p&&__p();for(var j=0;j<i.length;j++){var k=i[j],l=a[j],n=k.material===undefined?z():f.materials[k.material];n.aoMap&&l.attributes.uv2===undefined&&l.attributes.uv!==undefined&&(!1,l.addAttribute("uv2",new(b("ThreeJS.r88").BufferAttribute)(l.attributes.uv.array,2)));var o=l.attributes.color!==undefined,p=l.attributes.normal===undefined;if(o||p)if(n.isGLTFSpecularGlossinessMaterial){var q=e[d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];n=q.cloneMaterial(n)}else n=n.clone();o&&(n.vertexColors=b("ThreeJS.r88").VertexColors,n.needsUpdate=!0);p&&(n.flatShading=!0);if(k.mode===m.TRIANGLES||k.mode===undefined)q=new(b("ThreeJS.r88").Mesh)(l,n);else if(k.mode===m.TRIANGLE_STRIP)q=new(b("ThreeJS.r88").Mesh)(l,n),q.drawMode=b("ThreeJS.r88").TriangleStripDrawMode;else if(k.mode===m.TRIANGLE_FAN)q=new(b("ThreeJS.r88").Mesh)(l,n),q.drawMode=b("ThreeJS.r88").TriangleFanDrawMode;else if(k.mode===m.LINES)q=new(b("ThreeJS.r88").LineSegments)(l,n);else if(k.mode===m.LINE_STRIP)q=new(b("ThreeJS.r88").Line)(l,n);else if(k.mode===m.LINE_LOOP)q=new(b("ThreeJS.r88").LineLoop)(l,n);else if(k.mode===m.POINTS)q=new(b("ThreeJS.r88").Points)(l,n);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: ",k.mode);q.name=c.name||"mesh_"+g;k.targets!==undefined&&A(q,c,k,f);k.extras&&(q.userData=k.extras);if(i.length>1)q.name+="_"+j,h.add(q);else return q}return h})})})};B.prototype.loadCamera=function(a){__p&&__p();var c;a=this.json.cameras[a];var d=a[a.type];if(!d){!1;return}if(a.type==="perspective"){var e=d.aspectRatio||1,f=d.yfov*e;c=new(b("ThreeJS.r88").PerspectiveCamera)(b("ThreeJS.r88").Math.radToDeg(f),e,d.znear||1,d.zfar||2e6)}else a.type==="orthographic"&&(c=new(b("ThreeJS.r88").OrthographicCamera)(d.xmag/-2,d.xmag/2,d.ymag/2,d.ymag/-2,d.znear,d.zfar));a.name!==undefined&&(c.name=a.name);a.extras&&(c.userData=a.extras);return b("Promise").resolve(c)};B.prototype.loadSkins=function(){var a=this.json;return this._withDependencies(["accessors"]).then(function(b){return w(a.skins,function(a){a={joints:a.joints,inverseBindMatrices:b.accessors[a.inverseBindMatrices]};return a})})};B.prototype.loadAnimations=function(){__p&&__p();var a=this.json;return this._withDependencies(["accessors","nodes"]).then(function(c){__p&&__p();return w(a.animations,function(a,d){__p&&__p();var e=[];for(var f=0;f<a.channels.length;f++){var g=a.channels[f],h=a.samplers[g.sampler];if(h){g=g.target;var i=g.node!==undefined?g.node:g.id,j=a.parameters!==undefined?a.parameters[h.input]:h.input,k=a.parameters!==undefined?a.parameters[h.output]:h.output;j=c.accessors[j];k=c.accessors[k];var l=c.nodes[i];if(l){l.updateMatrix();l.matrixAutoUpdate=!0;var m;switch(t[g.path]){case t.weights:m=b("ThreeJS.r88").NumberKeyframeTrack;break;case t.rotation:m=b("ThreeJS.r88").QuaternionKeyframeTrack;break;case t.position:case t.scale:default:m=b("ThreeJS.r88").VectorKeyframeTrack;break}var n=l.name?l.name:l.uuid;h.interpolation==="CATMULLROMSPLINE"&&!1;h=h.interpolation!==undefined?u[h.interpolation]:b("ThreeJS.r88").InterpolateLinear;var o=[];t[g.path]===t.weights?l.traverse(function(a){a.isMesh===!0&&a.material.morphTargets===!0&&o.push(a.name?a.name:a.uuid)}):o.push(n);for(var l=0,n=o.length;l<n;l++)e.push(new m(o[l]+"."+t[g.path],b("ThreeJS.r88").AnimationUtils.arraySlice(j.array,0),b("ThreeJS.r88").AnimationUtils.arraySlice(k.array,0),h))}}}var i=a.name!==undefined?a.name:"animation_"+d;return new(b("ThreeJS.r88").AnimationClip)(i,undefined,e)})})};B.prototype.loadNodes=function(){__p&&__p();var a=this.json,c=this.extensions,e=this,f=a.nodes||[],g=a.skins||[],h={},i={};for(var j in g){var k=g[j].joints;for(var l=0;l<k.length;++l)f[k[l]].isBone=!0}for(var m in f){l=f[m];l.mesh!==undefined&&(h[l.mesh]===undefined&&(h[l.mesh]=i[l.mesh]=0),h[l.mesh]++)}return e._withDependencies(["meshes","skins","cameras"]).then(function(f){__p&&__p();return w(a.nodes,function(a){__p&&__p();if(a.isBone===!0)return new(b("ThreeJS.r88").Bone)();else if(a.mesh!==undefined){var g=f.meshes[a.mesh].clone();h[a.mesh]>1&&(g.name+="_instance_"+i[a.mesh]++);return g}else if(a.camera!==undefined)return e.getDependency("camera",a.camera);else if(a.extensions&&a.extensions[d.KHR_LIGHTS]&&a.extensions[d.KHR_LIGHTS].light!==undefined){g=c[d.KHR_LIGHTS].lights;return g[a.extensions[d.KHR_LIGHTS].light]}else return new(b("ThreeJS.r88").Object3D)()}).then(function(c){__p&&__p();return w(c,function(g,e){__p&&__p();e=a.nodes[e];e.name!==undefined&&(g.name=b("ThreeJS.r88").PropertyBinding.sanitizeNodeName(e.name));e.extras&&(g.userData=e.extras);if(e.matrix!==undefined){var h=new(b("ThreeJS.r88").Matrix4)();h.fromArray(e.matrix);g.applyMatrix(h)}else e.translation!==undefined&&g.position.fromArray(e.translation),e.rotation!==undefined&&g.quaternion.fromArray(e.rotation),e.scale!==undefined&&g.scale.fromArray(e.scale);if(e.skin!==undefined){h=[];var i=g.children.length>0?g.children:[g];for(var d=0;d<i.length;d++){var j=i[d],k=f.skins[e.skin],l=j.geometry,m=j.material;m.skinning=!0;l=new(b("ThreeJS.r88").SkinnedMesh)(l,m);l.morphTargetInfluences=j.morphTargetInfluences;l.userData=j.userData;l.name=j.name;m=[];j=[];for(var n=0,o=k.joints.length;n<o;n++){var p=k.joints[n];p=c[p];if(p){m.push(p);p=k.inverseBindMatrices.array;p=new(b("ThreeJS.r88").Matrix4)().fromArray(p,n*16);j.push(p)}else!1}l.bind(new(b("ThreeJS.r88").Skeleton)(m,j),l.matrixWorld);h.push(l)}g.children.length>0?(g.remove.apply(g,g.children),g.add.apply(g,h)):g=h[0]}return g})})})};B.prototype.loadScenes=function(){__p&&__p();var a=this.json,c=this.extensions;function e(b,c,d){__p&&__p();var f=d[b];c.add(f);c=a.nodes[b];if(c.children){b=c.children;for(var c=0,g=b.length;c<g;c++){var h=b[c];e(h,f,d)}}}return this._withDependencies(["nodes"]).then(function(f){__p&&__p();return w(a.scenes,function(a){__p&&__p();var g=new(b("ThreeJS.r88").Scene)();a.name!==undefined&&(g.name=a.name);a.extras&&(g.userData=a.extras);var h=a.nodes||[];for(var i=0,j=h.length;i<j;i++){var k=h[i];e(k,g,f.nodes)}g.traverse(function(a){a.material&&a.material.isGLTFSpecularGlossinessMaterial&&(a.onBeforeRender=c[d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)});if(a.extensions&&a.extensions[d.KHR_LIGHTS]&&a.extensions[d.KHR_LIGHTS].light!==undefined){k=c[d.KHR_LIGHTS].lights;g.add(k[a.extensions[d.KHR_LIGHTS].light])}return g})})};return a}(),e.exports=GLTFLoader}),null);
__d("GLTFLoader.r88.patch",["GLTFLoader.r88"],(function(a,b,c,d,e,f){e.exports.patch=function(){return b("GLTFLoader.r88")}}),null);
__d("Photo3dCameraControl",["Asset3dCameraControl","ThreeJS.r88","SphericalViewportControl","degToRad","getElementRect","Random"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("degToRad")(-10),i=b("degToRad")(20),j=b("degToRad")(-11),k=b("degToRad")(23),l=1,m=24,n=.08,o=b("degToRad")(5),p=b("degToRad")(3),q=.12,r=new(b("ThreeJS.r88").Vector3)(1,0,0),s=.001;c=babelHelpers.inherits(a,b("Asset3dCameraControl"));g=c&&c.prototype;function a(a,c,d,e,f,h){g.constructor.call(this,a,c,d,e,f),this.$Photo3dCameraControl1=!1,this.$Photo3dCameraControl2=0,this.$Photo3dCameraControl3=0,this.$Photo3dCameraControl4=0,this.$Photo3dCameraControl5=0,this.$Photo3dCameraControl6=b("Random").random()<.5,this.$Photo3dCameraControl8=null,this.$Photo3dCameraControl10=function(){this.setDirty(!0),this.$Photo3dCameraControl3+=n*(this.$Photo3dCameraControl5-this.$Photo3dCameraControl3),this.$Photo3dCameraControl2+=n*(this.$Photo3dCameraControl4-this.$Photo3dCameraControl2),Math.abs(this.$Photo3dCameraControl3-this.$Photo3dCameraControl5)>s||Math.abs(this.$Photo3dCameraControl2-this.$Photo3dCameraControl4)>s?this.$Photo3dCameraControl8=requestAnimationFrame(this.$Photo3dCameraControl10):this.$Photo3dCameraControl8=null}.bind(this),this.__camera.name="2.5D Photo Camera",this.$Photo3dCameraControl7=h}a.prototype.setupViewportListeners=function(){__p&&__p();this.__sphericalViewportControl.addListener("mouseMove",function(a){__p&&__p();var c=a.clientX;a=a.clientY;var d=b("getElementRect")(this.$Photo3dCameraControl7);if(c>d.left&&c<d.right&&a>d.top&&a<d.bottom){var e=.5*(d.left+d.right),f=.5*(d.top+d.bottom);this.$Photo3dCameraControl4=-2*(c-e)/d.width*o;this.$Photo3dCameraControl5=2*(a-f)/d.height*p;this.$Photo3dCameraControl1=!0;this.$Photo3dCameraControl9()}}.bind(this))};a.prototype.$Photo3dCameraControl9=function(){this.$Photo3dCameraControl8||(this.$Photo3dCameraControl8=requestAnimationFrame(this.$Photo3dCameraControl10))};a.prototype.modelLoad=function(a){this.setDirty(!0),this.__cameraTarget.set(0,0,-l),this.__cameraAnchor.position.set(0,0,-l),this.__camera.position.set(0,0,l),this.__camera.fov=m,this.__camera.updateProjectionMatrix()};a.prototype.update=function(a){__p&&__p();if(!this.isDirty())return;var b=h+i*(1-a),c=j+k*(1-a),d=(a-.25)*Math.PI/1.5;d=Math.max(0,d);d=q*(.6-Math.sin(d));this.__cameraTarget.set(0,0,-l);this.__cameraAnchor.position.set(0,0,-l);this.__camera.position.set(0,0,l+d);this.__camera.setRotationFromAxisAngle(r,c);this.$Photo3dCameraControl1||(this.$Photo3dCameraControl3=0,this.$Photo3dCameraControl2=(this.$Photo3dCameraControl6?1-2*a:2*a-1)*o);d=this.__pitch+this.$Photo3dCameraControl3+b;c=-this.__yaw+this.$Photo3dCameraControl2;this.__updateCameraAnchor(d,c)};e.exports=a}),null);
__d("SphericalMediaMouseOverlay.react",["cx","fbt","CSS","React","ReactDOM","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=800,k=function(a){return{mouseRoot:"_3bxe _2660"+(a?" _2dz7":""),mouse:"_2661"+(a?" _2dz7":""),mouseRotate:"_2663"+(a?" _2dz7":""),mouseInner:"_2664"+(a?" _2dz7":""),mouseLeftButton:"_2666"+(a?" _2dz7":""),mouseBackground:"_15nj",mouseButtons:"_2665",mouseRightButton:"_2667",mouseBody:"_266m",mouseText:"_2662"}};c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$2=null,b}a.prototype.componentDidUpdate=function(a){a.isActive&&!this.props.isActive?this.$2=setTimeout(function(){return this.$3()}.bind(this),j):!this.props.isActive?this.$3():this.props.isActive&&(this.$2!==null&&(clearTimeout(this.$2),this.$2=null),this.$4())};a.prototype.componentDidMount=function(){this.props.isActive||this.$3();var a=b("ReactDOM").findDOMNode(this);a instanceof HTMLElement&&(this.$1=a)};a.prototype.componentWillUnmount=function(){this.$1=null};a.prototype.$3=function(){this.$1&&b("CSS").addClass(this.$1,"_8b2")};a.prototype.$4=function(){this.$1&&b("CSS").removeClass(this.$1,"_8b2")};a.prototype.render=function(){var a=this.props,c=a.className;a=a.isActive;var d=this.props.copy?this.props.copy:h._("Click and drag to look around");a=k(a);return b("React").createElement("div",{className:b("joinClasses")(c,a.mouseRoot)},b("React").createElement("div",{className:a.mouse},b("React").createElement("div",{className:a.mouseRotate},b("React").createElement("div",{className:a.mouseInner},b("React").createElement("div",{className:a.mouseBackground}),b("React").createElement("div",{className:a.mouseButtons},b("React").createElement("div",{className:a.mouseLeftButton}),b("React").createElement("div",{className:a.mouseRightButton})),b("React").createElement("div",{className:a.mouseBody})))),b("React").createElement("div",{className:a.mouseText},d))};e.exports=a}),null);
__d("VertexAlphaMaterial",["ThreeJS.r88"],(function(a,b,c,d,e,f){var g,h=!1;c=babelHelpers.inherits(a,b("ThreeJS.r88").ShaderMaterial);g=c&&c.prototype;function a(a){"use strict";g.constructor.call(this,a),this.name="CustomVertexAlphaShader",this.vertexShader="#include <common>\n          #include <skinning_pars_vertex>\n          #include <clipping_planes_pars_vertex>\n          #include <fog_pars_vertex>\n          attribute vec4 color;\n          varying vec4 colorAlpha;\n          void main(void) {\n            #include <skinbase_vertex>\n            #include <begin_vertex>\n            #include <skinning_vertex>\n            #include <project_vertex>\n            #include <worldpos_vertex>\n            #include <clipping_planes_vertex>\n            #include <fog_vertex>\n            colorAlpha = color;\n          }",this.fragmentShader="#include <common>\n          #include <fog_pars_fragment>\n          #include <clipping_planes_pars_fragment>\n          uniform float opacity;\n          varying vec4 colorAlpha;\n          void main(void) {\n            #include <clipping_planes_fragment>\n            gl_FragColor = colorAlpha;\n            gl_FragColor.a *= opacity;\n            #include <fog_fragment>\n            #include <premultiplied_alpha_fragment>\n            "+(h?"gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);":"")+"\n          }",this.uniforms.fogColor={value:new(b("ThreeJS.r88").Color)()},this.uniforms.fogNear={value:0},this.uniforms.fogFar={value:0},this.uniforms.fogDensity={value:0},this.uniforms.opacity={value:1}}e.exports=a}),null);
__d("XAsset3DForLinkShareSrcController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/3d/linkshare/src/",{status_id:{type:"FBID",required:!0}})}),null);
__d("Asset3dFeedViewer.react",["ix","invariant","cx","csx","fbt","ActorURI","Animation","EventListener","Image.react","Link.react","React","ThreeJS.r88","Asset3dVrManager","VertexAlphaMaterial","GLTFLoader.r88.patch","SphericalMediaMouseOverlay.react","SphericalViewportControl","Asset3DUtils","GLTFSceneLoggerUtils","bind","CSS","DOMQuery","DOM","ReactDOM","Asset3dComponentContextMenu.react","Asset3dCameraControl","Asset3dTurntableCameraControl","Photo3dCameraControl","Asset3dEnterVrButton.react","asset","getElementRect","onViewportChanged","degToRad","radToDeg","gkx","Asset3DStatus","Asset3DBackground","Asset3DBackgroundSize","Asset3DCategory","promiseDone","AsyncRequest","XAsset3DForLinkShareSrcController"],(function(a,b,c,d,e,f,g,h,i,j,k){"use strict";__p&&__p();var l,m=b("GLTFLoader.r88.patch").patch(),n=10,o=.15,p=b("degToRad")(270),q=50,r=10,s=5,t=500,u=4e3,v=k._("Click and drag to look around in 3D"),w=function(a){a=!!a.composerID||!!a.attribution;return{sphericalOverlay:a?"_1r1y":""}};c=babelHelpers.inherits(a,b("React").Component);l=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=l.constructor).call.apply(a,[this].concat(e)),this.state={isNuxActive:!1,isVrDeviceReady:!1},this.$4=!0,this.$5=null,this.$7=null,this.$13=0,this.$14=!1,this.$17=0,this.$27=function(a){__p&&__p();a=a.getPayload();switch(a.status){case b("Asset3DStatus").UPLOADING:setTimeout(this.$24.bind(this),1e3);break;case b("Asset3DStatus").SUCCESS:this.$25(a.asset3d_id,a.glb_uri);break;case b("Asset3DStatus").FAIL:a=b("DOMQuery").find(this.props.initialViewContainer,this.props.category===b("Asset3DCategory").PHOTOS_3D?"._68op":"._623o");b("CSS").setClass(a,"_3gsr");a=b("DOM").create("div",{className:"_3gss"});b("DOM").setContent(a,k._("3D post failed to load"));b("DOM").appendContent(this.props.initialViewContainer,a);break}}.bind(this),this.$28=function(a,c,d){__p&&__p();d&&this.props.compressor&&this.props.compressionLevel&&(this.$6.logNetworkLoadEvents(d,this.props.compressor,this.props.compressionLevel),this.$6.logGlbParsingEvents(d));a=a.scene;this.$19.scene.add(a);this.$19.model=a;a.traverse(function(a){__p&&__p();if(a.isMesh){a=a;if(!a.geometry.isBufferGeometry)return;var c=a.material;c.map&&c.map.isTexture&&c.map.anisotropy===1&&(c.map.anisotropy=4);var d=a.geometry;d=d.getAttribute("color");var e=!1;if(d&&d.itemSize===4){for(var f=0,g=3;f<d.count;f++,g+=4)if(d.array[g]<1){e=!0;break}e&&(c=new(b("VertexAlphaMaterial"))({flatShading:c.flatShading,skinning:c.skinning,transparent:c.transparent,morphTargets:c.morphTargets,fog:!0,clipping:!0}));c.needsUpdate=!0;a.material=c}}});this.$29(a);c=b("onViewportChanged")(this.$30);c.scheduleCheck();this.$18=c}.bind(this),this.update=function(){__p&&__p();if(this.$6.data.timeSinceLastFPSLogMs<=r){var a=this.$19.clock.getDelta();this.$6.data.timeSinceLastFPSLogMs+=a;this.$6.data.frameCount+=1;if(this.$6.data.timeSinceLastFPSLogMs>r){a=this.$6.data.frameCount/this.$6.data.timeSinceLastFPSLogMs;this.$6.logAverageFrameRate(Math.round(a))}}(!this.$21||!this.$21.inVr())&&(this.$3&&(this.$31(),this.$32(),this.$5=requestAnimationFrame(this.update)))}.bind(this),this.$30=function(a){if(!this.$1)return;var c=b("getElementRect")(this.$1),d=a.top;a=a.bottom;d=c.top>d&&c.top<a||c.bottom>d&&c.bottom<a||d>c.top&&a<c.bottom;d&&this.$38(c);this.$3!==d&&(this.$3=d,d?this.$36():this.$37())}.bind(this),c}a.prototype.componentDidMount=function(){__p&&__p();this.$3=!1;this.$22=this.$23.bind(this);!this.props.glbURI?this.$24():this.$25();if(this.$1){b("EventListener").listen(this.$1,"contextmenu",function(a){(a.shiftKey||!b("gkx")("AT7S1ORqqWmAizRxUYQksN69cNfhDOQYw60edwhO6Ug3ApPyf3diuITOCUjwckzPlUcN_lM9JvGiRujA6vuJGfXo"))&&a.preventDefault()});b("EventListener").listen(this.$1,"dblclick",function(a){this.$12.resetCamera()}.bind(this));if(this.$1 instanceof HTMLElement){var a=b("React").createElement(b("Asset3dComponentContextMenu.react"),{target:this.$1,fileURL:this.props.glbURI});b("ReactDOM").render(a,this.$1)}}};a.prototype.componentWillUnmount=function(){clearTimeout(this.$15),clearTimeout(this.$16),this.$26()};a.prototype.UNSAFE_componentWillReceiveProps=function(a){a.glbURI&&a.glbURI!==this.props.glbURI&&(this.$3=!1,this.$4=!0,this.$26(),this.$25(a.asset3dID,a.glbURI))};a.prototype.$24=function(){if(this.$17>=n)return;var a=b("ActorURI").create(b("XAsset3DForLinkShareSrcController").getURIBuilder().setFBID("status_id",String(this.props.statusID)).getURI(),this.props.actorID);new(b("AsyncRequest"))().setURI(a).setMethod("GET").setReadOnly(!0).setHandler(b("bind")(this,this.$27)).setErrorHandler(function(a){a&&a.errorDescription&&!1}).send();this.$17+=1};a.prototype.$25=function(a,c){__p&&__p();var d=this.props,e=d.storyID,f=d.width,g=d.height;d=d.initialViewContainer;var i=this.$1;a=a?a:this.props.asset3dID;c=c?c:this.props.glbURI;if(!c||!i)return;f===1?(this.$10=d.clientWidth,this.$11=d.clientWidth):(this.$10=f,this.$11=g);i=new(b("ThreeJS.r88").Scene)();d=new(b("ThreeJS.r88").Clock)();f=new m();a||h(0);this.$6=new(b("GLTFSceneLoggerUtils"))(a,c,e);this.$19={clock:d,gltfLoader:f,light:null,scene:i,model:null};this.$7=null;f.load(c,this.$28)};a.prototype.$29=function(a){__p&&__p();var c=this.$1;if(!c)return;if(!window.asset3dRenderer){var d=new(b("ThreeJS.r88").WebGLRenderer)({antialias:!0,alpha:!0});d.gammaOutput=!0;d.setSize(this.$10,this.$11);d.setPixelRatio(window.devicePixelRatio);window.asset3dRenderer=d;window.asset3dRendererWidth=this.$10;window.asset3dRendererHeight=this.$11}else this.$10>window.asset3dRendererWidth&&(window.asset3dRenderer.setSize(this.$10,this.$11),window.asset3dRendererWidth=this.$10,window.asset3dRendererHeight=this.$11);d={enableGyro:!0,slipFactor:o,enableRubberBanding:!1,disableAutoClientSizeUpdate:!0,enableZoomWithShiftKey:!0,enablePanningWithRightMouse:!0};var e={expansionCoef:1.01,fieldOfView:q,initialHeading:b("radToDeg")(p),initialPitch:0,projectionType:"flat"};this.$2=document.createElement("canvas");this.$2.width=this.$10;this.$2.height=this.$11;c.appendChild(this.$2);this.$9=new(b("SphericalViewportControl"))(this.$2,e,d);this.$9.updateViewportClientSize({width:this.$10,height:this.$11});this.$9.addListener("updateViewportEnd",function(a,b){this.$13=0,clearTimeout(this.$15),this.$14=!1}.bind(this));this.$9.addListener("viewportChange",function(a,b,c){this.state.isNuxActive&&this.$12.shouldSuppressNux()&&this.setState({isNuxActive:!1})}.bind(this));this.$9.addListener("updateViewportMove",function(a){this.$13+=1,!this.$14&&!this.state.isNuxActive&&this.$13>s&&(this.$14=!0,this.$15=setTimeout(function(){this.setState({isNuxActive:!0},function(){this.$16=setTimeout(function(){this.state.isNuxActive&&this.setState({isNuxActive:!1})}.bind(this),u)}.bind(this)),this.$15=null}.bind(this),t))}.bind(this));this.$12=this.props.category===b("Asset3DCategory").PHOTOS_3D?new(b("Photo3dCameraControl"))(this.$9,this.$10,this.$11,this.$6,this.$19.scene,this.$2):new(b("Asset3dTurntableCameraControl"))(this.$9,this.$10,this.$11,this.$6,this.$19.scene);c=this.$12.camera();e=new(b("ThreeJS.r88").AmbientLight)(13421772,.5);this.$19.scene.add(e);this.$19.light=e;d=new(b("ThreeJS.r88").DirectionalLight)(15658734);d.position.set(1,2,1);c.add(d);this.$12.modelLoad(a);b("gkx")("AT48FWmB8_LKIn9ifpnl5Z88q4aHblWfFPq0uBpCazRb-PSc9Ulf_M6Be_QDzTo4zxt5oRiu0U-tCocoxSU2Cybn")&&new(b("ThreeJS.r88").TextureLoader)().load("/images/asset3d/packed.jpg",function(a){a.mapping=b("ThreeJS.r88").CubeUVReflectionMapping,a.minFilter=b("ThreeJS.r88").LinearFilter,a.magFilter=b("ThreeJS.r88").LinearFilter,this.$19.scene.traverse(function(b){b.material&&b.material.type=="MeshStandardMaterial"&&(b.material.envMap=a,b.material.envMapIntensity=2,b.material.needsUpdate=!0)}),this.$19.scene.remove(this.$19.light)}.bind(this));if(this.props.shouldUpdateFallbackImage){this.$8=.5;this.$31();this.$32(!1);e=b("Asset3DUtils").takeScreenshot(window.asset3dRenderer.domElement);b("Asset3DUtils").saveScreenshot(e,this.props.asset3dID,this.props.actorID)}if(this.props.enable3DPhotoWebVRSupport&&this.props.category===b("Asset3DCategory").PHOTOS_3D||this.props.enable3DModelWebVRSupport&&this.props.category!==b("Asset3DCategory").PHOTOS_3D){if(!window.asset3dVrManager){c=new(b("ThreeJS.r88").WebGLRenderer)({antialias:!0,alpha:!0});c.gammaOutput=!0;c.setSize(this.$10,this.$11);c.setPixelRatio(window.devicePixelRatio);window.asset3dVrManager=new(b("Asset3dVrManager"))(c)}this.$21=window.asset3dVrManager}};a.prototype.$26=function(){this.$21&&this.$33(),this.$5!=null&&(window.cancelAnimationFrame(this.$5),this.$5=null),this.$12&&this.$12.destroy(),this.$9!=null&&this.$9.destroy(),this.$1&&this.$2&&this.$2.parentNode===this.$1&&this.$1.removeChild(this.$2)};a.prototype.$31=function(){this.$12&&this.$12.update(this.$8)};a.prototype.$34=function(){var a=this;this.$21&&(function(){var c=a.$1;if(c){var d=a.props.storyProps;d||h(0);b("promiseDone")(a.$21.enterVr(a.props.category,a.$12.camera(),a.$19.model,a.$35.bind(a),d).then(function(){this.$21.domElement().parentElement===null&&(this.$20&&this.$20.setInVr(!0),window.cancelAnimationFrame(this.$5),this.$5=null,this.$19.scene.remove(this.$19.model),c.appendChild(this.$21.domElement()),c.removeChild(this.$2))}.bind(a)))}})()};a.prototype.$33=function(){this.$21&&b("promiseDone")(this.$21.exitVr())};a.prototype.$35=function(){var a=this.$1;a&&this.$21.domElement().parentElement===a&&(this.$20&&this.$20.setInVr(!1),a.appendChild(this.$2),a.removeChild(this.$21.domElement()),this.$19.scene.add(this.$19.model),this.$12.setDirty(!0),this.$5=requestAnimationFrame(this.update))};a.prototype.$36=function(){__p&&__p();if(this.$4){var a=Date.now();this.$6.logGpuUploadStart();this.$31();this.$32(!1);this.$6.logGpuUploadEnd(Date.now()-a);new(b("Animation"))(this.props.initialViewContainer).to("opacity",0).duration(350).hide().go();a=b("DOMQuery").scry(b("ReactDOM").findDOMNode(this),"._3xkn")[0];a&&new(b("Animation"))(a).to("opacity",1).duration(700).go();this.$4=!1}this.$21&&this.$21.addDeviceReadyListner(this.$22);requestAnimationFrame(this.update)};a.prototype.$37=function(){this.$21&&this.$21.removeDeviceReadyListner(this.$22)};a.prototype.$23=function(a){this.setState({isVrDeviceReady:a})};a.prototype.$32=function(){var a=arguments.length<=0||arguments[0]===undefined?!0:arguments[0],b=window.asset3dRenderer,c=this.$2.getContext("2d"),d=this.$12;if(b&&c&&d&&d.isDirty()){a&&d.setDirty(!1);c.clearRect(0,0,this.$10,this.$11);b.render(this.$19.scene,this.$12.camera());var e=b.getDrawingBufferSize(),f=e.width,g=e.height;c.drawImage(b.domElement,0,0,f,g,0,0,this.$10,this.$11)}};a.prototype.$38=function(a){if(!this.$1)return;var b=window.innerHeight||document.documentElement.clientHeight;a.height>.5*b?this.$8=a.bottom/(b+a.height):a.top<0?this.$8=.25*a.bottom/a.height:a.bottom>b?this.$8=.75+.25*(a.bottom-b)/a.height:this.$8=.25+.5*a.top/(b-a.height);this.$8!==this.$7&&(this.$7=this.$8,this.$12.setDirty(!0))};a.prototype.render=function(){__p&&__p();var a=null;if(this.props.attribution){var c=this.props.attribution.href,d=this.props.attribution.source,e=this.props.attribution.text;a=b("React").createElement("div",{className:"_3xkn"},b("React").createElement(b("Link.react"),{href:c,target:"_blank"},b("React").createElement(b("Image.react"),{className:"_47ru",src:g("459146")}),b("React").createElement("div",{className:"_47rt"},b("React").createElement("div",{className:"_377f"},e),b("React").createElement("div",{className:"_377g"},d?d:c))))}e={};this.props.background&&this.props.background!==b("Asset3DBackground").DEFAULT&&(e=b("Asset3DUtils").getBackgroundStyles(this.props.background,b("Asset3DBackgroundSize").STORY));d=w(this.props);c=void 0;this.props.height!==1&&(c={height:this.props.height});var f=void 0;this.state.isVrDeviceReady&&(f=b("React").createElement(b("Asset3dEnterVrButton.react"),{ref:function(a){return this.$20=a}.bind(this),enterVrCallback:function(){this.$34()}.bind(this),exitVrCallback:function(){this.$33()}.bind(this)}));return b("React").createElement("div",{style:e},b("React").createElement("div",{style:c,ref:function(a){return this.$1=a}.bind(this)}),b("React").createElement(b("SphericalMediaMouseOverlay.react"),{className:d.sphericalOverlay,isActive:this.state.isNuxActive,copy:v}),a,f)};a.defaultProps={storyID:null,asset3dID:null,statusID:null,glbURI:null,compressor:null,compressionLevel:null,attribution:null,height:1,width:1,composerID:null,background:null,enable3DModelWebVRSupport:!1,enable3DPhotoWebVRSupport:!1,shouldUpdateFallbackImage:!1,storyProps:null};e.exports=a}),null);